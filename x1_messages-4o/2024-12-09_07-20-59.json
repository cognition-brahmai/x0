[
    {
        "role": "user",
        "content": "How can I set a single proxy for a Python requests session object? I am using the Python requests package to send HTTP requests and I want to add a single proxy to the requests session object. My current code is:\n\n<pre><code>session = requests.Session()\nsession.proxies = {...} # Here I want to add a single proxy\n</code></pre>\n\nHowever, at present I am looping through a bunch of proxies, and at each iteration a new session is made. I want to set a single proxy for each iteration. The example from the documentation is:\n\n<pre><code>proxies = {\n    \"http\": \"http://10.10.1.10:3128\",\n    \"https://10.10.1.10:1080\",\n}\n\nrequests.get(\"http://example.org\", proxies=proxies)\n</code></pre>\n\nI've tried to follow this but it doesn't work. Here is the line of code from my script:\n\n<pre><code># eg. line = 59.43.102.33:80\nr = s.get('http://icanhazip.com', proxies={'http': 'http://' + line})\n</code></pre>\n\nBut I get an error:\n\n<pre><code>requests.packages.urllib3.exceptions.LocationParseError: Failed to parse 59.43.102.33:80\n</code></pre>\n\nCan anyone help me understand how to set a single proxy on a session object?"
    },
    {
        "role": "assistant",
        "content": "To set a single proxy for a Python `requests` session object, you need to ensure that the proxy URL is correctly formatted. The error you're encountering typically occurs when the proxy URL is not properly formatted or when there's a missing scheme (such as \"http://\"). Here's how you can correctly set a single proxy for a `requests.Session` object:\n\n1. Make sure your proxy URL includes the scheme (e.g., \"http://\").\n2. Assign the proxy to both \"http\" and \"https\" if you want to use the same proxy for both types of requests.\n\nHere's an example of how you can set a single proxy for a session:\n\n```python\nimport requests\n\n# Create a session object\nsession = requests.Session()\n\n# Define your proxy\nproxy_host = \"59.43.102.33\"\nproxy_port = \"80\"\nproxy = f\"http://{proxy_host}:{proxy_port}\"\n\n# Set the proxy for the session\nsession.proxies = {\n    \"http\": proxy,\n    \"https\": proxy\n}\n\n# Make a request using the session\ntry:\n    response = session.get('http://icanhazip.com')\n    print(response.text)\nexcept requests.exceptions.RequestException as e:\n    print(f\"An error occurred: {e}\")\n```\n\nIn this example, the proxy is set for both \"http\" and \"https\" requests. If you want to use different proxies for different protocols, you can specify them separately in the `session.proxies` dictionary.\n\nMake sure to replace `proxy_host` and `proxy_port` with the actual values of the proxy you want to use. This should resolve the `LocationParseError` you're encountering."
    }
]