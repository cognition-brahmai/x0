[
    {
        "role": "user",
        "content": "How can I perform the reverse operation of 'melt' in Pandas in Python? I have a dataset where each row represents a combination of 'label' and 'type', along with its corresponding 'value'. I'd like to convert this into a new format where each distinct 'label' forms a row, and the columns are the distinct 'type', with the 'value' as the cell values. The starting data is as follows:\n\n```python\nimport pandas as pd\nfrom StringIO import StringIO\n\norigin = pd.read_table(StringIO('''label    type    value\nx   a   1\nx   b   2\nx   c   3\ny   a   4\ny   b   5\ny   c   6\nz   a   7\nz   b   8\nz   c   9'''))\n\norigin\nOut[5]: \n  label type  value\n0     x    a      1\n1     x    b      2\n2     x    c      3\n3     y    a      4\n4     y    b      5\n5     y    c      6\n6     z    a      7\n7     z    b      8\n8     z    c      9\n```\n\nThe desired output is:\n\n```python\n    label   a   b   c\n        x   1   2   3\n        y   4   5   6\n        z   7   8   9\n```"
    },
    {
        "role": "assistant",
        "content": "To perform the reverse operation of 'melt' in Pandas, you can use the `pivot` method. This will allow you to reshape the data from long to wide format, where each unique value in the 'type' column becomes a new column, and the 'value' column provides the values for these new columns. Here's how you can achieve the desired transformation:\n\n```python\nimport pandas as pd\nfrom io import StringIO\n\n# Your original data\ndata = '''label    type    value\nx   a   1\nx   b   2\nx   c   3\ny   a   4\ny   b   5\ny   c   6\nz   a   7\nz   b   8\nz   c   9'''\n\n# Read the data into a DataFrame\norigin = pd.read_csv(StringIO(data), sep='\\s+')\n\n# Use pivot to reshape the data\nresult = origin.pivot(index='label', columns='type', values='value').reset_index()\n\n# Rename the columns to match the desired output\nresult.columns.name = None\n\n# Display the result\nprint(result)\n```\n\nThis code will give you the following output:\n\n```\n  label  a  b  c\n0     x  1  2  3\n1     y  4  5  6\n2     z  7  8  9\n```\n\nThe `pivot` function is used to reshape the table by setting 'label' as the index, 'type' as the columns, and 'value' as the values to fill the table. The `reset_index()` method is used to bring the 'label' back as a column rather than an index."
    }
]