[
    {
        "role": "user",
        "content": "How can I sort a Pandas DataFrame based on multiple criteria? I have a DataFrame with song names, their peak chart positions, and the number of weeks they stayed at position number one. I want to sort these songs according to their popularity, with songs reaching the highest position coming first, and in the case of a tie, the songs that stayed on the charts the longest coming first. How can I achieve this in Pandas?\n\nHere is the DataFrame I am working with:\n\n```\n                                          Song            Peak            Weeks\n76                            Paperback Writer               1               16\n117                               Lady Madonna               1                9\n118                                   Hey Jude               1               27\n22                           Can't Buy Me Love               1               17\n29                          A Hard Day's Night               1               14\n48                              Ticket To Ride               1               14\n56                                       Help!               1               17\n109                       All You Need Is Love               1               16\n173                The Ballad Of John And Yoko               1               13\n85                               Eleanor Rigby               1               14\n87                            Yellow Submarine               1               14\n20                    I Want To Hold Your Hand               1               24\n45                                 I Feel Fine               1               15\n60                                 Day Tripper               1               12\n61                          We Can Work It Out               1               12\n10                               She Loves You               1               36\n155                                   Get Back               1                6\n8                               From Me To You               1                7\n115                              Hello Goodbye               1                7\n2                             Please Please Me               2               20\n92                   Strawberry Fields Forever               2               12\n93                                  Penny Lane               2               13\n107                       Magical Mystery Tour               2               16\n176                                  Let It Be               2               14\n0                                   Love Me Do               4               26\n157                                  Something               4                9\n166                              Come Together               4               10\n58                                   Yesterday               8               21\n135                       Back In The U.S.S.R.              19                3\n164                         Here Comes The Sun              58               19\n96       Sgt. Pepper's Lonely Hearts Club Band              63               12\n105         With A Little Help From My Friends              63                7\n```"
    },
    {
        "role": "assistant",
        "content": "To sort a Pandas DataFrame based on multiple criteria, you can use the `sort_values` method. In your case, you want to sort the DataFrame first by the `Peak` column in ascending order (since a lower peak value indicates a higher chart position), and then by the `Weeks` column in descending order (to prioritize songs that stayed longer at the top position in case of ties).\n\nHere's how you can achieve this:\n\n```python\nimport pandas as pd\n\n# Assuming your DataFrame is named 'df'\ndf = pd.DataFrame({\n    'Song': [\n        \"Paperback Writer\", \"Lady Madonna\", \"Hey Jude\", \"Can't Buy Me Love\", \n        \"A Hard Day's Night\", \"Ticket To Ride\", \"Help!\", \"All You Need Is Love\", \n        \"The Ballad Of John And Yoko\", \"Eleanor Rigby\", \"Yellow Submarine\", \n        \"I Want To Hold Your Hand\", \"I Feel Fine\", \"Day Tripper\", \n        \"We Can Work It Out\", \"She Loves You\", \"Get Back\", \"From Me To You\", \n        \"Hello Goodbye\", \"Please Please Me\", \"Strawberry Fields Forever\", \n        \"Penny Lane\", \"Magical Mystery Tour\", \"Let It Be\", \"Love Me Do\", \n        \"Something\", \"Come Together\", \"Yesterday\", \"Back In The U.S.S.R.\", \n        \"Here Comes The Sun\", \"Sgt. Pepper's Lonely Hearts Club Band\", \n        \"With A Little Help From My Friends\"\n    ],\n    'Peak': [\n        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 4, 4, 4, 8, 19, 58, 63, 63\n    ],\n    'Weeks': [\n        16, 9, 27, 17, 14, 14, 17, 16, 13, 14, 14, 24, 15, 12, 12, 36, 6, 7, 7, 20, 12, 13, 16, 14, 26, 9, 10, 21, 3, 19, 12, 7\n    ]\n})\n\n# Sort the DataFrame first by 'Peak' in ascending order, then by 'Weeks' in descending order\nsorted_df = df.sort_values(by=['Peak', 'Weeks'], ascending=[True, False])\n\nprint(sorted_df)\n```\n\nThis code will sort the DataFrame such that songs are ordered by their peak chart position first, and by the number of weeks they stayed at that position in case of ties. The `ascending=[True, False]` argument specifies that the `Peak` column should be sorted in ascending order while the `Weeks` column should be sorted in descending order."
    }
]