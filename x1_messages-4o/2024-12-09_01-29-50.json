[
    {
        "role": "user",
        "content": "I have a pandas dataframe with various columns each having different datatypes like object, float64, and datetime64[ns]. How can I get a list of the dataframe columns that are of type 'object' or 'datetime'? I want to use this list to run a function that converts 'float64' numbers to two decimal places."
    },
    {
        "role": "assistant",
        "content": "You can achieve this by filtering the columns based on their data types and then using this filtered list to apply any function you need. Here's how you can do it using pandas:\n\n```python\nimport pandas as pd\n\n# Sample DataFrame\ndata = {\n    'A': ['foo', 'bar', 'baz'],\n    'B': [1.12345, 2.67891, 3.54321],\n    'C': pd.to_datetime(['2023-01-01', '2023-01-02', '2023-01-03']),\n    'D': [4.56789, 5.12345, 6.78901]\n}\n\ndf = pd.DataFrame(data)\n\n# Get a list of columns that are of type 'object' or 'datetime64[ns]'\ncols_of_interest = df.select_dtypes(include=['object', 'datetime64[ns]']).columns.tolist()\n\n# Function to format float64 numbers to two decimal places\ndef format_floats_to_two_decimals(df):\n    # Iterate through each column in the DataFrame\n    for col in df.columns:\n        # If the column is of type float64, round to two decimal places\n        if df[col].dtype == 'float64':\n            df[col] = df[col].round(2)\n\n# Apply the function to the DataFrame\nformat_floats_to_two_decimals(df)\n\n# Print the columns of interest and the modified DataFrame\nprint(\"Columns of interest (object or datetime):\", cols_of_interest)\nprint(\"\\nModified DataFrame:\")\nprint(df)\n```\n\nThis script will:\n\n1. Create a sample DataFrame.\n2. Identify and list the columns with data types 'object' or 'datetime64[ns]'.\n3. Define a function to format float64 numbers to two decimal places.\n4. Apply the function to the DataFrame.\n5. Print the list of columns and the modified DataFrame.\n\nYou can adapt this code to your specific DataFrame and requirements."
    }
]