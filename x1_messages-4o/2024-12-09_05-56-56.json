[
    {
        "role": "user",
        "content": "I have a time series pandas dataframe with columns for temperature and radiation, sampled every minute. How can I down-sample this dataframe to a resolution of one hour, while applying different functions to each column? Specifically, I want to compute the hourly mean for the temperature and the hourly sum for the radiation.\n\nHere's my current code:\n\n```python\nimport datetime\nimport pandas as pd\nimport numpy as np\n\ndate_times = pd.date_range(datetime.datetime(2012, 4, 5, 8, 0),\n                           datetime.datetime(2012, 4, 5, 12, 0),\n                           freq='1min')\ntamb = np.random.sample(date_times.size) * 10.0\nradiation = np.random.sample(date_times.size) * 10.0\nframe = pd.DataFrame(data={'tamb': tamb, 'radiation': radiation},\n                     index=date_times)\nframe\n<class 'pandas.core.frame.DataFrame'>\nDatetimeIndex: 241 entries, 2012-04-05 08:00:00 to 2012-04-05 12:00:00\nFreq: T\nData columns:\nradiation    241  non-null values\ntamb         241  non-null values\ndtypes: float64(2)\n```"
    },
    {
        "role": "assistant",
        "content": "To down-sample your DataFrame to a resolution of one hour while applying different aggregation functions to each column, you can use the `resample` method in pandas along with the `agg` method. Here's how you can modify your code to achieve this:\n\n```python\nimport datetime\nimport pandas as pd\nimport numpy as np\n\n# Create the datetime index and data\ndate_times = pd.date_range(datetime.datetime(2012, 4, 5, 8, 0),\n                           datetime.datetime(2012, 4, 5, 12, 0),\n                           freq='1min')\ntamb = np.random.sample(date_times.size) * 10.0\nradiation = np.random.sample(date_times.size) * 10.0\n\n# Create the DataFrame\nframe = pd.DataFrame(data={'tamb': tamb, 'radiation': radiation}, index=date_times)\n\n# Resample the DataFrame to hourly intervals\nresampled_frame = frame.resample('H').agg({'tamb': 'mean', 'radiation': 'sum'})\n\n# Display the resampled DataFrame\nprint(resampled_frame)\n```\n\n### Explanation:\n- The `resample('H')` function is used to down-sample the data to one-hour intervals.\n- The `agg` method allows you to specify different aggregation functions for each column. In this case, `'mean'` is used for the `tamb` column, and `'sum'` is used for the `radiation` column.\n- The resulting DataFrame `resampled_frame` will have one entry per hour with the specified aggregation applied to each column."
    }
]