[
    {
        "role": "user",
        "content": "I am using Scikit-learn in my project and I need to calculate the True positive (TP), False Positive (FP), True Negative (TN) and False Negative (FN) from a confusion matrix. The confusion matrix is as follows:\n\n```python\n[[2 0 3 4]\n [0 4 5 1]\n [1 0 3 2]\n [5 0 0 4]]\n```\n\nWhile I have figured out how to calculate the TP, the FP and the FN, I am unsure about how to calculate the TN. Could someone guide me on how to do this?"
    },
    {
        "role": "assistant",
        "content": "Certainly! To calculate the True Positives (TP), False Positives (FP), False Negatives (FN), and True Negatives (TN) from a confusion matrix in a multi-class classification setting, you need to understand these terms:\n\n1. **True Positive (TP)**: The model correctly predicts the positive class.\n2. **False Positive (FP)**: The model incorrectly predicts the positive class.\n3. **False Negative (FN)**: The model incorrectly predicts the negative class.\n4. **True Negative (TN)**: The model correctly predicts the negative class.\n\nIn a multi-class confusion matrix like the one you have, each class has its own TP, FP, FN, and TN. Let's break down how to calculate these for each class.\n\n### Confusion Matrix:\n```\n[[2 0 3 4]\n [0 4 5 1]\n [1 0 3 2]\n [5 0 0 4]]\n```\n\n### Calculations for Each Class:\n\nFor each class, you can calculate:\n\n- **TP**: The value on the diagonal of the confusion matrix for that class.\n- **FP**: The sum of the values in the corresponding column minus TP.\n- **FN**: The sum of the values in the corresponding row minus TP.\n- **TN**: The sum of all values in the matrix minus TP, FP, and FN.\n\nLet's calculate these for each class:\n\n#### Class 0:\n- **TP (0,0)**: 2\n- **FP**: Sum of column 0 (2 + 0 + 1 + 5) - TP = 8 - 2 = 6\n- **FN**: Sum of row 0 (2 + 0 + 3 + 4) - TP = 9 - 2 = 7\n- **TN**: Total sum (28) - (TP + FP + FN) = 28 - (2 + 6 + 7) = 13\n\n#### Class 1:\n- **TP (1,1)**: 4\n- **FP**: Sum of column 1 (0 + 4 + 0 + 0) - TP = 4 - 4 = 0\n- **FN**: Sum of row 1 (0 + 4 + 5 + 1) - TP = 10 - 4 = 6\n- **TN**: Total sum (28) - (TP + FP + FN) = 28 - (4 + 0 + 6) = 18\n\n#### Class 2:\n- **TP (2,2)**: 3\n- **FP**: Sum of column 2 (3 + 5 + 3 + 0) - TP = 11 - 3 = 8\n- **FN**: Sum of row 2 (1 + 0 + 3 + 2) - TP = 6 - 3 = 3\n- **TN**: Total sum (28) - (TP + FP + FN) = 28 - (3 + 8 + 3) = 14\n\n#### Class 3:\n- **TP (3,3)**: 4\n- **FP**: Sum of column 3 (4 + 1 + 2 + 4) - TP = 11 - 4 = 7\n- **FN**: Sum of row 3 (5 + 0 + 0 + 4) - TP = 9 - 4 = 5\n- **TN**: Total sum (28) - (TP + FP + FN) = 28 - (4 + 7 + 5) = 12\n\nThis way, you can calculate TP, FP, FN, and TN for each class in your multi-class confusion matrix."
    }
]