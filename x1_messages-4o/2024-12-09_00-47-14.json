[
    {
        "role": "user",
        "content": "I am working with a dictionary of data frames in Python, where each data frame has the same columns and similar index. For instance, the dictionary is defined as follows:\n\n```python\ndict = {'ABC': df1, 'XYZ' : df2}   # of any length...\n```\n\nEach data frame has the following structure:\n\n```python\ndata           Open     High      Low    Close   Volume\nDate                                                   \n2002-01-17  0.18077  0.18800  0.16993  0.18439  1720833\n2002-01-18  0.18439  0.21331  0.18077  0.19523  2027866\n2002-01-21  0.19523  0.20970  0.19162  0.20608   771149\n```\n\nI am looking for the simplest way to combine all the data frames into one, with a multi-index like the following:\n\n```python\nsymbol         ABC                                       XYZ\ndata           Open     High      Low    Close   Volume  Open ...\nDate                                                   \n2002-01-17  0.18077  0.18800  0.16993  0.18439  1720833  ...\n2002-01-18  0.18439  0.21331  0.18077  0.19523  2027866  ...\n2002-01-21  0.19523  0.20970  0.19162  0.20608   771149  ...\n```\n\nI've tried a few methods - for example, for each data frame, replace the columns with a multi-index like `.from_product(['ABC', columns])` and then concatenate along `axis=1`, but without success. How can I achieve this?"
    },
    {
        "role": "assistant",
        "content": "To achieve the desired structure, you can use the `pandas.concat` function to concatenate your data frames along the columns (`axis=1`) while setting the keys parameter to use the dictionary keys as the top-level of the MultiIndex for the columns. Here's how you can do it:\n\n```python\nimport pandas as pd\n\n# Assuming df1 and df2 are your data frames\ndict_of_dfs = {'ABC': df1, 'XYZ': df2}\n\n# Concatenate the data frames with a MultiIndex for columns\ncombined_df = pd.concat(dict_of_dfs, axis=1)\n\n# The result will have a MultiIndex for columns with the dictionary keys as the top level\nprint(combined_df)\n```\n\nThis code will create a DataFrame `combined_df` with a MultiIndex on the columns, where the top-level index is the keys from your dictionary (e.g., 'ABC', 'XYZ'), and the second level is the columns from each DataFrame (e.g., 'Open', 'High', 'Low', 'Close', 'Volume').\n\nMake sure that each DataFrame in your dictionary has the same index, as this method relies on aligning the DataFrames along their index. If they have different indices, you might need to handle those differences before concatenating."
    }
]