[
    {
        "role": "user",
        "content": "I am trying to create a single legend for multiple axes in a subplot using matplotlib in python. My subplot contains two axes with different scales on the same subplot, and I want to create a single legend for both axes. In my current approach, I am using the following code:\n\n```python\nfig1.suptitle('Test')\nax1 = fig1.add_subplot(221)\nax1.plot(x,y1,color='b',label='aVal')\nax2 = ax1.twinx()\nax2.plot(x,y2,color='g',label='bVal')\nax2.grid( ls='--', color='black')\nlegend([ax1,ax2], loc=2)\n```\n\nHowever, this does not work as expected. It only produces details from ax2 and not from ax1. How can I modify my code to create a single legend that includes details from both ax1 and ax2?"
    },
    {
        "role": "assistant",
        "content": "To create a single legend that includes details from both `ax1` and `ax2` in your subplot, you need to gather the handles and labels from both axes and then pass them to the `legend()` function. Here's how you can modify your code to achieve this:\n\n```python\nimport matplotlib.pyplot as plt\n\n# Sample data\nx = [0, 1, 2, 3, 4, 5]\ny1 = [0, 1, 4, 9, 16, 25]\ny2 = [25, 16, 9, 4, 1, 0]\n\nfig1 = plt.figure()\nfig1.suptitle('Test')\n\nax1 = fig1.add_subplot(221)\nline1, = ax1.plot(x, y1, color='b', label='aVal')\n\nax2 = ax1.twinx()\nline2, = ax2.plot(x, y2, color='g', label='bVal')\nax2.grid(ls='--', color='black')\n\n# Combine handles and labels from both axes\nlines = [line1, line2]\nlabels = [line.get_label() for line in lines]\n\n# Create a single legend\nax1.legend(lines, labels, loc='upper left')\n\nplt.show()\n```\n\n### Key Changes:\n\n1. **Handles and Labels**: Instead of using `legend([ax1, ax2], loc=2)`, which doesn't correctly gather information from both axes, manually collect the line objects (`line1` and `line2`) and their labels.\n\n2. **Create the Legend**: Use `ax1.legend()` or `ax2.legend()` to set the legend using the handles and labels from both axes. This allows you to have a single legend that combines line information from both `ax1` and `ax2`.\n\nThis approach ensures that both datasets' information is included in a single legend on your plot."
    }
]