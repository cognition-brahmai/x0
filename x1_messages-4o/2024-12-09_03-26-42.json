[
    {
        "role": "user",
        "content": "How can I use python-docx to replace a specific word in a Word document and then save it? I have a task to open a MS-Word 2007+ document with a single line of text and replace any \"key\" word in a dictionary that occurs in that line of text with its dictionary value. The document should then be closed and saved with everything else remaining the same. I have tried using python-docx 0.7.2 and other versions of the module but I haven't been able to find a solution. I am encountering a 'NameError: name 'coreprops' is not defined' error message when trying to perform this task. I am currently using the 64 bit version of Enthought's Canopy on OSX 10.9.3."
    },
    {
        "role": "assistant",
        "content": "To replace a specific word in a Word document using `python-docx`, you need to iterate through the document's paragraphs and replace the target words with their corresponding values from a dictionary. Here's a step-by-step guide on how to achieve this:\n\n1. **Install python-docx**: Ensure you have the `python-docx` library installed. You can install it via pip if it's not already installed:\n\n   ```bash\n   pip install python-docx\n   ```\n\n2. **Create a Python script** to perform the word replacement. Here's a sample script to guide you through the process:\n\n   ```python\n   from docx import Document\n\n   # Load the document\n   doc = Document('your-document.docx')\n\n   # Define the dictionary of words to replace\n   replacement_dict = {\n       'oldWord1': 'newWord1',\n       'oldWord2': 'newWord2',\n       # Add more words as needed\n   }\n\n   # Iterate through each paragraph in the document\n   for para in doc.paragraphs:\n       # Iterate through each key-value pair in the dictionary\n       for old_word, new_word in replacement_dict.items():\n           if old_word in para.text:\n               # Replace the old word with the new word\n               para.text = para.text.replace(old_word, new_word)\n\n   # Save the modified document\n   doc.save('modified-document.docx')\n   ```\n\n3. **Handle Errors**: Ensure your script doesn't have any syntax errors, and the module `coreprops` is not required for your task. The `NameError: name 'coreprops' is not defined'` suggests that there might be a typo or a misconfigured import in your script. The script above does not rely on `coreprops`.\n\n4. **Test the Script**: Run the script in your Python environment and ensure that it correctly opens the document, replaces the specified words, and saves the document with the changes.\n\n5. **Verify the Output**: Open the `modified-document.docx` file to verify that the replacements have been made successfully.\n\nIf you continue to face issues, ensure all your Python packages are up-to-date, and check for any potential conflicts or errors in your setup. If the error persists, consider creating a new virtual environment and reinstalling the necessary packages."
    }
]