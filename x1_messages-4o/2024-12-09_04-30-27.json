[
    {
        "role": "user",
        "content": "I have two simple pandas DataFrames as shown below:\n\n```python\nleft = pd.DataFrame({'col1' : ['A', 'B', 'C'], 'col2' : [1, 2, 3]})\nright = pd.DataFrame({'col1' : ['X', 'Y', 'Z'], 'col2' : [20, 30, 50]})\n\nleft\n\n  col1  col2\n0    A     1\n1    B     2\n2    C     3\n\nright\n\n  col1  col2\n0    X    20\n1    Y    30\n2    Z    50\n```\n\nI want to compute the cartesian product (or CROSS JOIN) of these two DataFrames, such that the output will look like:\n\n```\nA       1      X      20\nA       1      Y      30\nA       1      Z      50\nB       2      X      20\nB       2      Y      30\nB       2      Z      50\nC       3      X      20\nC       3      Y      30\nC       3      Z      50\n```\n\nWhat would be the most performant method of achieving this?"
    },
    {
        "role": "assistant",
        "content": "To compute the Cartesian product (or cross join) of two pandas DataFrames, you can use the `merge` function with the `how='cross'` parameter, which is available from pandas version 1.2.0 onwards. This method is both straightforward and performant. Here's how you can achieve the desired result:\n\n```python\nimport pandas as pd\n\n# Define the DataFrames\nleft = pd.DataFrame({'col1': ['A', 'B', 'C'], 'col2': [1, 2, 3]})\nright = pd.DataFrame({'col1': ['X', 'Y', 'Z'], 'col2': [20, 30, 50]})\n\n# Perform a cross join\nresult = pd.merge(left, right, how='cross')\n\n# Display the result\nprint(result)\n```\n\nThis will give you the following output:\n\n```\n  col1_x  col2_x col1_y  col2_y\n0      A       1      X      20\n1      A       1      Y      30\n2      A       1      Z      50\n3      B       2      X      20\n4      B       2      Y      30\n5      B       2      Z      50\n6      C       3      X      20\n7      C       3      Y      30\n8      C       3      Z      50\n```\n\nThis method efficiently computes the Cartesian product by cross joining the two DataFrames. If you're using a version of pandas earlier than 1.2.0, you can achieve the same result by adding a key column to both DataFrames and merging on this column, but using `how='cross'` is much simpler and more intuitive."
    }
]