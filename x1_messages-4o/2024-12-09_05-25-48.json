[
    {
        "role": "user",
        "content": "I have installed TensorFlow on Ubuntu 16.04, following the method detailed in the second answer on this [forum post](https://devtalk.nvidia.com/default/topic/936429/-solved-tensorflow-with-gpu-in-anaconda-env-ubuntu-16-04-cuda-7-5-cudnn-/). I'm using a GTX 960m GPU. How can I verify if TensorFlow is utilizing GPU acceleration from within the Python shell? When I run `import tensorflow`, I receive the following output:\n\n```console\nI tensorflow/stream_executor/dso_loader.cc:105] successfully opened CUDA library libcublas.so locally\nI tensorflow/stream_executor/dso_loader.cc:105] successfully opened CUDA library libcudnn.so locally\nI tensorflow/stream_executor/dso_loader.cc:105] successfully opened CUDA library libcufft.so locally\nI tensorflow/stream_executor/dso_loader.cc:105] successfully opened CUDA library libcuda.so.1 locally\nI tensorflow/stream_executor/dso_loader.cc:105] successfully opened CUDA library libcurand.so locally\n```\nIs this output enough to ascertain that TensorFlow is using the GPU?"
    },
    {
        "role": "assistant",
        "content": "The output you provided indicates that TensorFlow has successfully loaded the necessary CUDA libraries, which is a good sign that it's set up to utilize the GPU. However, to explicitly verify that TensorFlow is using the GPU for computations, you can run the following Python code:\n\n```python\nimport tensorflow as tf\n\n# Check if TensorFlow can access a GPU\ngpu_devices = tf.config.experimental.list_physical_devices('GPU')\nif gpu_devices:\n    print(\"TensorFlow is using the following GPU(s):\")\n    for device in gpu_devices:\n        print(device)\nelse:\n    print(\"No GPUs found. TensorFlow is not utilizing GPU acceleration.\")\n```\n\nThis script will list the GPUs available to TensorFlow. If the output shows your GPU, then TensorFlow is capable of utilizing it for acceleration.\n\nIf you are using a version of TensorFlow older than 2.0, you may need to use the following code instead:\n\n```python\nfrom tensorflow.python.client import device_lib\n\ndef get_available_gpus():\n    local_device_protos = device_lib.list_local_devices()\n    return [x for x in local_device_protos if x.device_type == 'GPU']\n\ngpus = get_available_gpus()\nif gpus:\n    print(\"TensorFlow is using the following GPU(s):\")\n    for gpu in gpus:\n        print(gpu)\nelse:\n    print(\"No GPUs found. TensorFlow is not utilizing GPU acceleration.\")\n```\n\nRunning either of these scripts will help you determine if TensorFlow is correctly set up to use your GPU. If no GPUs are listed, there might be an issue with your installation or configuration."
    }
]