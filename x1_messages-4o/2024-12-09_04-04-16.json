[
    {
        "role": "user",
        "content": "How can I configure Sphinx to look for modules in a virtual environment when building HTML documentation? I have already entered the virtual environment, but when I try to run the `make html` command, I get errors indicating that the module cannot be imported. I suspect these errors are occurring because the module isn't available in my native environment. How can I specify that Sphinx should use the virtual environment when searching for documentation?"
    },
    {
        "role": "assistant",
        "content": "When you're using Sphinx to generate documentation for a project that's located within a virtual environment, you need to ensure that Sphinx has access to the libraries installed in that virtual environment. Here are some steps you can take to configure Sphinx to correctly include modules from your virtual environment:\n\n1. **Activate the Virtual Environment:**\n   Ensure that your virtual environment is activated before you run the `make html` command. This ensures that Python uses the packages installed in your virtual environment.\n\n   ```bash\n   source /path/to/your/venv/bin/activate  # On Unix or MacOS\n   # or\n   .\\path\\to\\your\\venv\\Scripts\\activate  # On Windows\n   ```\n\n2. **Configure `sys.path` in `conf.py`:**\n   You need to add the path of your modules to the `sys.path` list in the `conf.py` file of your Sphinx documentation.\n\n   Open the `conf.py` file in your Sphinx documentation directory and add the following lines at the top:\n\n   ```python\n   import os\n   import sys\n   sys.path.insert(0, os.path.abspath('/path/to/your/module'))\n   ```\n\n   Replace `'/path/to/your/module'` with the actual path to the directory where your Python modules are located. This makes sure that Sphinx can find your modules when it builds the documentation.\n\n3. **Ensure Dependencies are Installed:**\n   Make sure all necessary dependencies for your project are installed in the virtual environment. You can do this by running:\n\n   ```bash\n   pip install -r requirements.txt\n   ```\n\n   This will ensure that all required packages are available in the virtual environment.\n\n4. **Check for Import Errors:**\n   If you're still encountering import errors, double-check the module names and paths to ensure they are correct. Sometimes, issues arise from typos or incorrect directory structures.\n\n5. **Use the `autodoc` Extension:**\n   If you are using the `autodoc` extension, ensure it is listed in the `extensions` list in your `conf.py`:\n\n   ```python\n   extensions = [\n       'sphinx.ext.autodoc',\n       # other extensions\n   ]\n   ```\n\n6. **Re-run Sphinx:**\n   After making these changes, you should clean the previous build and then attempt to build the HTML documentation again:\n\n   ```bash\n   make clean\n   make html\n   ```\n\nBy following these steps, Sphinx should be able to locate and include the modules from your virtual environment when building the HTML documentation."
    }
]