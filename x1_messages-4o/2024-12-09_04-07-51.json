[
    {
        "role": "user",
        "content": "How can I construct a query using SQLAlchemy and SQLite3 to select rows where a String column contains a specific substring?"
    },
    {
        "role": "assistant",
        "content": "To select rows where a string column contains a specific substring using SQLAlchemy with SQLite3, you can utilize the `like` method or the `contains` method provided by SQLAlchemy. Here\u2019s how you can construct such a query:\n\nFirst, make sure you have SQLAlchemy installed. If not, you can install it using pip:\n\n```bash\npip install sqlalchemy\n```\n\nThen, you can use the following code to construct your query:\n\n```python\nfrom sqlalchemy import create_engine, Column, String, Integer, Table, MetaData\nfrom sqlalchemy.sql import select\n\n# Create an in-memory SQLite database\nengine = create_engine('sqlite:///:memory:')\n\n# Define a metadata instance\nmetadata = MetaData()\n\n# Define a sample table\nsample_table = Table(\n    'sample_table', metadata,\n    Column('id', Integer, primary_key=True),\n    Column('name', String),\n)\n\n# Create the table\nmetadata.create_all(engine)\n\n# Insert sample data\nwith engine.connect() as connection:\n    connection.execute(sample_table.insert(), [\n        {'name': 'John Doe'},\n        {'name': 'Jane Smith'},\n        {'name': 'Alice Johnson'},\n        {'name': 'Bob Brown'},\n    ])\n\n# Define the substring you are searching for\nsubstring = \"John\"\n\n# Construct a query to select rows where 'name' contains the substring\nquery = select(sample_table).where(sample_table.c.name.contains(substring))\n\n# Execute the query and fetch results\nwith engine.connect() as connection:\n    result = connection.execute(query)\n    for row in result:\n        print(row)\n```\n\n### Key Points:\n\n- **Database Setup**: In this example, an in-memory SQLite database is used for simplicity. You can replace `'sqlite:///:memory:'` with your database URI.\n- **Metadata and Table Definition**: The `sample_table` is defined with `id` and `name` columns.\n- **Inserting Data**: Sample data is inserted into the table.\n- **Query Construction**: The `contains` method is used to filter rows where the `name` column contains the specified substring.\n- **Executing the Query**: The query is executed, and the results are printed.\n\nYou can replace the table and column names as needed to fit your specific database schema."
    }
]