[
    {
        "role": "user",
        "content": "How can I combine two dataframes in Python using pandas to create one dataframe with a hierarchical column index? My current dataframes are as follows:\n\n```python\n>>> df1\n              A    B\n2000-01-01  1.4  1.4\n2000-01-02  1.7 -1.9\n2000-01-03 -0.2 -0.8\n\n>>> df2\n              A    B\n2000-01-01  0.6 -0.3\n2000-01-02 -0.4  0.6\n2000-01-03  1.1 -1.0\n```\n\nI want the resultant dataframe to look like this:\n\n```python\n            df1       df2\n              A    B    A    B\n2000-01-01  1.4  1.4  0.6 -0.3\n2000-01-02  1.7 -1.9 -0.4  0.6\n2000-01-03 -0.2 -0.8  1.1 -1.0\n```"
    },
    {
        "role": "assistant",
        "content": "To combine the two dataframes with a hierarchical column index in pandas, you can use the `pandas.concat` function with the `keys` parameter. By providing keys, you can create a MultiIndex for the columns, where each DataFrame is represented by a level in the hierarchy. Here's how you can do it:\n\n```python\nimport pandas as pd\n\n# Sample dataframes\ndf1 = pd.DataFrame({\n    'A': [1.4, 1.7, -0.2],\n    'B': [1.4, -1.9, -0.8]\n}, index=pd.to_datetime(['2000-01-01', '2000-01-02', '2000-01-03']))\n\ndf2 = pd.DataFrame({\n    'A': [0.6, -0.4, 1.1],\n    'B': [-0.3, 0.6, -1.0]\n}, index=pd.to_datetime(['2000-01-01', '2000-01-02', '2000-01-03']))\n\n# Concatenating the dataframes with hierarchical columns\nresult = pd.concat([df1, df2], axis=1, keys=['df1', 'df2'])\n\nprint(result)\n```\n\nThis will give you the desired output:\n\n```\n            df1       df2      \n              A    B    A    B\n2000-01-01  1.4  1.4  0.6 -0.3\n2000-01-02  1.7 -1.9 -0.4  0.6\n2000-01-03 -0.2 -0.8  1.1 -1.0\n```\n\nIn this approach, `pd.concat` is used with `axis=1` to concatenate along the columns, and the `keys` parameter is used to create the hierarchical column index."
    }
]