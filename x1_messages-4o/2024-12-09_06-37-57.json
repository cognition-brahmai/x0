[
    {
        "role": "user",
        "content": "Why isn't the default column value being set to 10 in SQLAlchemy? I am using Postgresql 9.1 and SQLAlchemy 0.9. Here's my code:\n\n```python\nconn_str = 'postgresql://test:pass@localhost/test'\nengine = create_engine(conn_str)\nmetadata = MetaData(bind=engine)\n\ncols=[]\ncols += [Column('Name', VARCHAR(20), primary_key=True, nullable=False)]\ncols += [Column('age', INT, default=10, nullable=False )]\nTable('t1', metadata, *cols)\nmetadata.create_all(engine)\n```\n\nWhen I check the table structure in psql, I don't see the default value for 'age' column. It should look like this:\n\n```sql\ntest=&gt; \\dS t2\n              Table \"public.t2\"\n Column |         Type          | Modifiers\n--------+-----------------------+------------\n Name   | character varying(10) | not null\n age    | integer               | default 10\nIndexes:\n    \"t2_pkey\" PRIMARY KEY, btree (\"Name\")\n```\n\nBut it looks like this:\n\n```sql\ntest=&gt; \\dS t1\n            Table \"public.t1\"\nColumn |         Type          | Modifiers\n--------+-----------------------+-----------\nName   | character varying(20) | not null\nage    | integer               | not null\nIndexes:\n    \"t1_pkey\" PRIMARY KEY, btree (\"Name\")\n```\n\nWhat am I doing wrong?"
    },
    {
        "role": "assistant",
        "content": "The issue you're encountering is due to the use of `default` in SQLAlchemy, which is not the same as `server_default`. Let's clarify the difference:\n\n- `default`: This is a client-side default. SQLAlchemy sets this value when the object is created in Python but not directly in the database schema.\n- `server_default`: This is a server-side default. This sets the default value at the database level and is what you want to use if you want to see the default value reflected in the database schema when you inspect it.\n\nHere's how you can modify your code to use `server_default`:\n\n```python\nfrom sqlalchemy import create_engine, MetaData, Table, Column, VARCHAR, INT, text\n\nconn_str = 'postgresql://test:pass@localhost/test'\nengine = create_engine(conn_str)\nmetadata = MetaData(bind=engine)\n\ncols = []\ncols += [Column('Name', VARCHAR(20), primary_key=True, nullable=False)]\ncols += [Column('age', INT, server_default=text('10'), nullable=False)]\nTable('t1', metadata, *cols)\nmetadata.create_all(engine)\n```\n\nBy using `server_default=text('10')`, you're specifying that the default value for the `age` column should be set at the database level, which will be reflected in the schema when you inspect the table using `psql`."
    }
]