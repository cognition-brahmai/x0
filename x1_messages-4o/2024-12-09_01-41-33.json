[
    {
        "role": "user",
        "content": "How can I get the properly cased path for a file in Python? I am currently working with Windows which uses case-insensitive file names, so I can open the same file with any of these paths:\n\n```python\nr\"c:\\windows\\system32\\desktop.ini\"\nr\"C:\\WINdows\\System32\\DESKTOP.ini\"\nr\"C:\\WiNdOwS\\SyStEm32\\DeSkToP.iNi\"\n```\nGiven any of these paths, I want to find the true case such that all the paths produce the following output:\n\n```python\nr\"C:\\Windows\\System32\\desktop.ini\"\n```\nI have tried using `os.path.normcase`, `os.path.abspath`, and `os.path.realpath`, but none of them provide the result I am looking for. The `os.path.normcase` function lowercases everything, `os.path.abspath` returns an absolute path (which doesn't help because each of these paths is already absolute), and `os.path.realpath` is only used to resolve symbolic links, which are not present in Windows. Is there a straightforward way to solve this?"
    },
    {
        "role": "assistant",
        "content": "To get the properly cased path for a file in Windows using Python, you can use the `win32api` module from the `pywin32` library, which provides Windows-specific extensions. This allows you to retrieve the correct casing of the file path by querying the Windows API.\n\nHere's how you can do it:\n\n1. Ensure you have the `pywin32` library installed. You can install it using pip if it's not already installed:\n\n   ```bash\n   pip install pywin32\n   ```\n\n2. Use the following Python code to obtain the properly cased path:\n\n   ```python\n   import win32api\n\n   def get_properly_cased_path(path):\n       # Get the short path name first\n       short_path = win32api.GetShortPathName(path)\n       # Convert it back to the long path name with proper casing\n       properly_cased_path = win32api.GetLongPathName(short_path)\n       return properly_cased_path\n\n   # Example usage\n   path1 = r\"c:\\windows\\system32\\desktop.ini\"\n   path2 = r\"C:\\WINdows\\System32\\DESKTOP.ini\"\n   path3 = r\"C:\\WiNdOwS\\SyStEm32\\DeSkToP.iNi\"\n\n   print(get_properly_cased_path(path1))\n   print(get_properly_cased_path(path2))\n   print(get_properly_cased_path(path3))\n   ```\n\nThis code uses `GetShortPathName` to get a short path version of the given file path, and then `GetLongPathName` to retrieve the properly cased version of the path. This approach works because the Windows API maintains the correct casing of file paths, even though the file system is case-insensitive."
    }
]