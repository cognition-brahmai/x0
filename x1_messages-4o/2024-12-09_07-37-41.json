[
    {
        "role": "user",
        "content": "I am trying to copy a sheet, 'default_sheet', into a new sheet 'new_sheet' in the same workbook using openpyxl 1.8.2. I have managed to create a new sheet and copy the values from the default sheet, but I am struggling to copy the style of each cell into the new_sheet cells. How can I also copy the style of each cell into the new_sheet cells? Here is the current code I am using:\n\n```\nnew_sheet = workbook.create_sheet()\nnew_sheet.title = sheetName\ndefault_sheet = workbook.get_sheet_by_name('default')\nnew_sheet = workbook.get_sheet_by_name(sheetName)\nfor row in default_sheet.rows:\n    col_idx = float(default_sheet.get_highest_column())\nstarting_col = chr(65 + int(col_idx))\nfor row in default_sheet.rows:\n    for cell in row:\n        new_sheet[cell.get_coordinate()] = cell.value\n        <copy also style of each cell>\n```\n\nI tried one solution using copy:\n\n```\nfrom copy import copy, deepcopy\n\nnew_sheet._styles[cell.get_coordinate()] = copy(\n        default_sheet._styles[cell.get_coordinate()])\n```\n\nBut it's not working as expected. Can you guide me on how to successfully copy the cell style from default sheet to new sheet?"
    },
    {
        "role": "assistant",
        "content": "To copy cell styles from one sheet to another using openpyxl, you'll need to copy various attributes individually, as openpyxl doesn't provide a direct method for copying styles between sheets. Here's how you can do it:\n\n1. Copy the cell value.\n2. Copy the cell's font, fill, border, alignment, and number format.\n\nHere's an updated version of your code to achieve this:\n\n```python\nfrom openpyxl import load_workbook\nfrom openpyxl.utils import get_column_letter\nfrom openpyxl.styles import Font, Fill, Border, Alignment, numbers\n\n# Load your workbook\nworkbook = load_workbook('your_workbook.xlsx')\n\n# Create a new sheet\nnew_sheet = workbook.create_sheet(title='new_sheet')\n\n# Get the default sheet\ndefault_sheet = workbook['default']\n\n# Iterate over the rows and columns in the default sheet\nfor row in default_sheet.iter_rows():\n    for cell in row:\n        # Get the coordinate of the cell\n        new_cell = new_sheet[cell.coordinate]\n\n        # Copy the cell value\n        new_cell.value = cell.value\n\n        # Copy the cell style\n        if cell.has_style:\n            new_cell.font = copy(cell.font)\n            new_cell.fill = copy(cell.fill)\n            new_cell.border = copy(cell.border)\n            new_cell.alignment = copy(cell.alignment)\n            new_cell.number_format = cell.number_format\n\n# Save the workbook\nworkbook.save('your_updated_workbook.xlsx')\n```\n\n### Key Points:\n\n- **Font**: Handles text styling like bold, italic, etc.\n- **Fill**: Manages background color and pattern.\n- **Border**: Controls cell borders.\n- **Alignment**: Deals with text alignment within the cell.\n- **Number Format**: Ensures numerical data retains its formatting.\n\nBy copying each of these individually, you should be able to replicate the cell styles in the new sheet. Make sure to save the workbook after making changes to ensure they persist."
    }
]