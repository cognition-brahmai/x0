[
    {
        "role": "user",
        "content": "How can I exclude South migrations from my Django application's test coverage reports using coverage.py? I am using South for my database migrations and these files are showing up with 0% in the test coverage, which is affecting the overall percentage. I have tried using `--omit=*migrations*` in both the `run` and `report` commands, but it didn't solve the issue. I have been testing this with versions 3.4 and the latest revision from Bitbucket as of December 20th, 2010, but with no success. Can anyone suggest a method to make coverage.py ignore the migrations folders?"
    },
    {
        "role": "assistant",
        "content": "To exclude South migrations or any specific files from your Django application's test coverage reports using `coverage.py`, you need to ensure that the coverage configuration is correctly set up to omit the desired files. Here\u2019s a step-by-step guide to help you achieve this:\n\n1. **Use a `.coveragerc` Configuration File**: Create a `.coveragerc` file in the root directory of your project if you don\u2019t already have one. This file allows you to specify configuration settings for `coverage.py`.\n\n2. **Configure the Omit Option**: Within your `.coveragerc` file, you can specify which files or directories to omit using the `[run]` section. Here\u2019s a sample configuration:\n\n   ```ini\n   [run]\n   omit =\n       */migrations/*\n   ```\n\n   This will omit any file paths that contain `/migrations/`, which should effectively exclude your South migrations.\n\n3. **Ensure Correct Path Patterns**: Double-check that the path pattern you use in the `omit` option correctly matches the structure of your project. If your migrations are in a specific directory structure, adjust the pattern accordingly.\n\n4. **Run Coverage with the Configuration File**: Make sure you run your coverage commands with the configuration from `.coveragerc`. Typically, this is automatic as long as the file is in the root of your project:\n\n   ```bash\n   coverage run manage.py test\n   coverage report\n   ```\n\n5. **Verify the Setup**: After running your tests and generating the report, verify that the migration files are no longer included. You can also use:\n\n   ```bash\n   coverage html\n   ```\n\n   To generate an HTML report to visually inspect the coverage results.\n\n6. **Version Compatibility**: Since you mentioned using older versions of `coverage.py`, consider updating to a more recent version if possible, as there may have been bug fixes or improvements since the version you are currently using.\n\nBy following these steps, you should be able to exclude the South migrations from your test coverage reports effectively. If you continue to face issues, ensure that your `.coveragerc` file is being read by `coverage.py` and that there are no typos in the directory paths specified in the `omit` section."
    }
]