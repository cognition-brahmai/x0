[
    {
        "role": "user",
        "content": "Construct a SQL query which will output the first and last names of all the individuals whose birth year is earlier than 1990, according to the data in the \"People\" table of the company database, which includes columns for first name, last name, birth date, and other personal information. The birth date must be parsed from the date format in the \"BirthDate\" column, which is in ISO 8601 format (YYYY-MM-DD). The query must only include people who have a valid birth date recorded and must exclude any individuals who have incomplete or missing personal information. Additionally, the query must sort the output alphabetically by last name and then by first name."
    },
    {
        "role": "assistant",
        "content": "To construct an SQL query that meets the specified requirements, you'll need to ensure that the query accurately filters, sorts, and selects the relevant data. Here's an example of how you can achieve this:\n\n```sql\nSELECT FirstName, LastName\nFROM People\nWHERE BirthDate IS NOT NULL \n  AND BirthDate <> '' \n  AND SUBSTR(BirthDate, 1, 4) < '1990'\n  AND FirstName IS NOT NULL \n  AND LastName IS NOT NULL \n  AND FirstName <> '' \n  AND LastName <> ''\nORDER BY LastName ASC, FirstName ASC;\n```\n\n### Explanation:\n\n1. **SELECT Statement**: \n   - Selects the `FirstName` and `LastName` columns.\n\n2. **FROM Clause**: \n   - Specifies the `People` table as the source of the data.\n\n3. **WHERE Clause**: \n   - `BirthDate IS NOT NULL`: Ensures that the birth date is not null.\n   - `BirthDate <> ''`: Ensures that the birth date is not an empty string.\n   - `SUBSTR(BirthDate, 1, 4) < '1990'`: Extracts the year from the `BirthDate` and checks if it is earlier than 1990.\n   - `FirstName IS NOT NULL` and `LastName IS NOT NULL`: Ensures that both first and last names are not null.\n   - `FirstName <> ''` and `LastName <> ''`: Ensures that both first and last names are not empty strings.\n\n4. **ORDER BY Clause**: \n   - Sorts the results first by `LastName` in ascending order, and then by `FirstName` in ascending order.\n\nThis query will output the first and last names of all individuals born before 1990, with valid and complete personal information, sorted alphabetically by last name and then by first name."
    }
]