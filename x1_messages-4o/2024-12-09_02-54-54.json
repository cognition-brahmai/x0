[
    {
        "role": "user",
        "content": "How can I prevent numpy from utilizing multithreading on a shared compute server? I regularly run jobs on this server, and I want to limit the usage to 10 cores to avoid interfering with other users' processes. I am currently using Enthought 7.3-1 on Redhat, which is based on Python 2.7.3 and numpy 1.6.1."
    },
    {
        "role": "assistant",
        "content": "To prevent NumPy from utilizing multithreading and to limit its usage to a specific number of cores, you can control the environment variables that manage OpenBLAS, MKL, or other underlying BLAS libraries that NumPy might be using for linear algebra operations. Here are some general steps you can follow:\n\n1. **OpenBLAS**: If NumPy is using OpenBLAS, you can set the `OPENBLAS_NUM_THREADS` environment variable to limit the number of threads. You can do this in your shell before running your Python script:\n\n   ```bash\n   export OPENBLAS_NUM_THREADS=10\n   ```\n\n2. **MKL**: If NumPy is using Intel's MKL, you can set the `MKL_NUM_THREADS` environment variable:\n\n   ```bash\n   export MKL_NUM_THREADS=10\n   ```\n\n3. **BLIS**: If NumPy is using BLIS, set the `BLIS_NUM_THREADS` environment variable:\n\n   ```bash\n   export BLIS_NUM_THREADS=10\n   ```\n\n4. **NumPy Configuration**: If you're not sure which BLAS library NumPy is using, you can set multiple environment variables just to be safe. You can add the export commands to your shell's initialization file (like `.bashrc` or `.bash_profile`) to make these settings persistent for your user.\n\n5. **Python Code**: Alternatively, you can configure these settings within your Python script using the `os` module:\n\n   ```python\n   import os\n\n   os.environ['OPENBLAS_NUM_THREADS'] = '10'\n   os.environ['MKL_NUM_THREADS'] = '10'\n   os.environ['BLIS_NUM_THREADS'] = '10'\n   ```\n\n6. **Check BLAS Library**: To determine which BLAS library your NumPy is using, you can check the configuration by running:\n\n   ```python\n   import numpy as np\n   np.__config__.show()\n   ```\n\nThis will print out information about which libraries are being used by NumPy. Adjust the environment variables accordingly based on the library in use.\n\nBy setting these environment variables, you should be able to limit the number of cores used by NumPy on your shared compute server."
    }
]