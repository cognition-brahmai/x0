[
    {
        "role": "user",
        "content": "How can I fix the color range on multiple scatter plots and add in a colorbar to each plot in matplotlib? I want the plots to be directly comparable by eye, with each data point retaining its color between plots and not getting remapped to a different color due to the change in max/min of the subset versus the whole set. I've tried using vmin, vmax, and clim(x,y), but none of these seem to be working. How can I achieve this?"
    },
    {
        "role": "assistant",
        "content": "To ensure that each scatter plot uses the same color range and includes a colorbar, you can specify a common `vmin` and `vmax` for all the plots. This will ensure that the color mapping is consistent across all plots. Here is a step-by-step guide on how to achieve this using `matplotlib`:\n\n1. **Determine the Common Color Range:**\n   - Calculate the minimum and maximum values across all data points that you want to plot. These will serve as your `vmin` and `vmax`.\n\n2. **Create Scatter Plots with Consistent Color Mapping:**\n   - Use the `vmin` and `vmax` parameters in the `scatter` function to ensure consistency.\n\n3. **Add Colorbars to Each Plot:**\n   - Use `fig.colorbar()` to add a colorbar to each subplot, making sure to use the same colormap.\n\nHere is a code example that demonstrates this process:\n\n```python\nimport matplotlib.pyplot as plt\nimport numpy as np\n\n# Example data\ndata1 = np.random.rand(100, 3)  # 100 points, 3 columns (x, y, color)\ndata2 = np.random.rand(100, 3)\n\n# Determine color range across all datasets\nall_data = np.vstack((data1, data2))\nvmin = np.min(all_data[:, 2])\nvmax = np.max(all_data[:, 2])\n\n# Create subplots\nfig, axes = plt.subplots(1, 2, figsize=(12, 6))\n\n# Plot data1\nsc1 = axes[0].scatter(data1[:, 0], data1[:, 1], c=data1[:, 2], vmin=vmin, vmax=vmax, cmap='viridis')\naxes[0].set_title('Plot 1')\ncbar1 = fig.colorbar(sc1, ax=axes[0])\ncbar1.set_label('Color Scale')\n\n# Plot data2\nsc2 = axes[1].scatter(data2[:, 0], data2[:, 1], c=data2[:, 2], vmin=vmin, vmax=vmax, cmap='viridis')\naxes[1].set_title('Plot 2')\ncbar2 = fig.colorbar(sc2, ax=axes[1])\ncbar2.set_label('Color Scale')\n\nplt.tight_layout()\nplt.show()\n```\n\n### Key Points:\n- **`vmin` and `vmax`**: Ensure these are consistent across all plots to maintain the same color scale.\n- **Colormap (`cmap`)**: Use the same colormap for each scatter plot.\n- **Colorbar**: Adding a colorbar to each subplot ensures that the viewer can interpret the color scale correctly.\n\nBy following this approach, you should be able to make your scatter plots directly comparable by eye, with consistent color mapping across multiple plots."
    }
]