[
    {
        "role": "user",
        "content": "How can I unzip a specific folder from a .zip file using Python? For instance, if I have a zip file named 'archive.zip' which contains two folders 'foo' and 'bar', how can I only unzip the 'foo' folder to a specific location while retaining its folder structure?"
    },
    {
        "role": "assistant",
        "content": "To unzip a specific folder from a `.zip` file using Python, you can utilize the `zipfile` module. You'll need to iterate through the contents of the zip file and extract only the files that belong to the desired folder, preserving the folder structure. Here's a step-by-step guide and a code example to achieve this:\n\n1. **Import the necessary module**: You'll need the `zipfile` module to work with zip files.\n2. **Open the zip file**: Use `zipfile.ZipFile` to open the zip file in read mode.\n3. **Iterate through the contents**: Loop through each file in the zip file.\n4. **Check for the specific folder**: Filter files that start with the folder name you want to extract.\n5. **Extract the files**: Use the `extract` method to extract the filtered files to the specified location.\n\nHere's an example code that demonstrates how to do this:\n\n```python\nimport zipfile\nimport os\n\ndef extract_specific_folder(zip_path, folder_name, extract_to):\n    with zipfile.ZipFile(zip_path, 'r') as zip_ref:\n        # Iterate over the file names in the zip file\n        for member in zip_ref.namelist():\n            # Check if the file is in the desired folder\n            if member.startswith(folder_name + '/'):\n                # Extract the file, preserving the folder structure\n                zip_ref.extract(member, extract_to)\n\n# Example usage\nzip_file_path = 'archive.zip'  # Path to your zip file\ntarget_folder = 'foo'          # Folder you want to extract\noutput_path = 'output_directory'  # Destination directory for extraction\n\n# Ensure the output directory exists\nos.makedirs(output_path, exist_ok=True)\n\nextract_specific_folder(zip_file_path, target_folder, output_path)\n```\n\n**Explanation**:\n- `zipfile.ZipFile(zip_path, 'r')` opens the zip file in read mode.\n- `zip_ref.namelist()` gets a list of all the file names in the zip file.\n- `member.startswith(folder_name + '/')` checks if the file is part of the target folder, ensuring the folder hierarchy is preserved.\n- `zip_ref.extract(member, extract_to)` extracts the file to the specified destination while maintaining the directory structure.\n\nThis approach will extract only the files that belong to the `foo` folder from `archive.zip` to the `output_directory`, maintaining the folder hierarchy of `foo`."
    }
]