[
    {
        "role": "user",
        "content": "I am working with Python argparse and I'm trying to add an optional argument that defaults to a specified value if only the flag is present without a value. However, if the user specifies a value, I want it to store the user-specified value instead of the default. Is there an existing action available for this? Here's an example of what I'm trying to achieve:\n\n```\npython script.py --example\n# args.example would equal a default value of 1\npython script.py --example 2\n# args.example would equal a default value of 2\n```\n\nI know I can create an action, but I'm curious if there's a built-in way already available to achieve this."
    },
    {
        "role": "assistant",
        "content": "In Python's `argparse` module, there isn't a direct built-in action that does exactly what you're describing, where a flag can have a default value when specified without an argument but allows for a different value if provided. However, you can achieve this behavior by using a combination of the `nargs` parameter and custom logic in your script.\n\nHere's how you can do it:\n\n1. Use `nargs='?'` to indicate that the argument is optional and can take zero or one value.\n2. Use the `const` parameter to define the default value to use when the flag is present without an argument.\n3. Implement logic to handle cases where the flag is not present at all.\n\nHere's an example:\n\n```python\nimport argparse\n\ndef main():\n    parser = argparse.ArgumentParser(description=\"Example script.\")\n    \n    # Define the optional argument with nargs='?' and const\n    parser.add_argument('--example', nargs='?', const=1, type=int,\n                        help=\"Optional argument with a default value of 1 when flag is present without a value.\")\n    \n    args = parser.parse_args()\n\n    # If --example is not provided, default to None or any other desired value\n    example_value = args.example if args.example is not None else 'No flag provided'\n    \n    print(f\"The value of --example is: {example_value}\")\n\nif __name__ == \"__main__\":\n    main()\n```\n\nHere's how this works:\n\n- When you run `python script.py --example`, the `example` argument will have the value `1` (from `const`).\n- When you run `python script.py --example 2`, the `example` argument will have the value `2`.\n- If you don't provide the `--example` flag at all, `args.example` will be `None`, and you can handle it as needed in your logic.\n\nThis setup allows you to have a default value if the flag is used without a specific value, and also lets you override that default by providing a value explicitly."
    }
]