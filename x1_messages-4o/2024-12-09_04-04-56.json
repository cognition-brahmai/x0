[
    {
        "role": "user",
        "content": "I have a DataFrame in pandas which has a MultiIndex created after some grouping. Here's my current DataFrame:\n\n```python\nimport numpy as np\nimport pandas as pd\nfrom numpy.random import randn\n\ndf = pd.DataFrame({'A' : ['a1', 'a1', 'a2', 'a3'], \n                   'B' : ['b1', 'b2', 'b3', 'b4'], \n                   'Vals' : randn(4)}\n                 ).groupby(['A', 'B']).sum()\n\n#            Vals\n# A  B           \n# a1 b1 -1.632460\n#    b2  0.596027\n# a2 b3 -0.619130\n# a3 b4 -0.002009\n```\nI would like to prepend a level to the MultiIndex to transform it into something like this:\n\n```python\n#                       Vals\n# FirstLevel A  B           \n# Foo        a1 b1 -1.632460\n#               b2  0.596027\n#            a2 b3 -0.619130\n#            a3 b4 -0.002009\n```\nHow can I achieve this?"
    },
    {
        "role": "assistant",
        "content": "You can prepend a level to the MultiIndex by using the `pd.MultiIndex.from_product` function to create a new MultiIndex with the additional level, and then reassigning it to the DataFrame's index. Here's how you can do it:\n\n```python\nimport numpy as np\nimport pandas as pd\nfrom numpy.random import randn\n\n# Create the initial DataFrame and group it\ndf = pd.DataFrame({'A' : ['a1', 'a1', 'a2', 'a3'], \n                   'B' : ['b1', 'b2', 'b3', 'b4'], \n                   'Vals' : randn(4)}\n                 ).groupby(['A', 'B']).sum()\n\n# Create a new MultiIndex with the additional level\nnew_index = pd.MultiIndex.from_product([['Foo'], df.index.get_level_values('A'), df.index.get_level_values('B')],\n                                       names=['FirstLevel', 'A', 'B'])\n\n# Reassign the new MultiIndex to the DataFrame\ndf.index = new_index\n\nprint(df)\n```\n\nThis will give you the desired output:\n\n```\n                       Vals\nFirstLevel A  B           \nFoo        a1 b1 -1.632460\n              b2  0.596027\n           a2 b3 -0.619130\n           a3 b4 -0.002009\n```\n\nHere, `pd.MultiIndex.from_product` is used to generate a new MultiIndex with the desired structure, and this new index is then applied to the DataFrame."
    }
]