[
    {
        "role": "user",
        "content": "How can I extract all images from a PDF document, at native resolution and format, using Python? I want to extract the images in their original format, such as TIFF as TIFF, JPEG as JPEG, without resampling. The layout is not important to me, I don't need to know the source image's location on the page. I'm currently using Python 2.7, but I can use 3.x if required."
    },
    {
        "role": "assistant",
        "content": "To extract images from a PDF document in their native resolution and format using Python, you can use libraries such as `PyMuPDF` (part of the `fitz` module) or `pdf2image`. Here's a guide using `PyMuPDF`, which is well-suited for this task as it allows you to extract images in their original format without resampling.\n\nFirst, you'll need to install the `PyMuPDF` library. You can do this using `pip`:\n\n```bash\npip install PyMuPDF\n```\n\nHere's a sample script to extract images using `PyMuPDF`:\n\n```python\nimport fitz  # PyMuPDF\nimport io\nfrom PIL import Image\n\ndef extract_images_from_pdf(pdf_path, output_folder):\n    # Open the PDF file\n    pdf_document = fitz.open(pdf_path)\n    \n    for page_number in range(len(pdf_document)):\n        page = pdf_document.load_page(page_number)\n        image_list = page.get_images(full=True)\n        \n        for image_index, img in enumerate(image_list):\n            xref = img[0]\n            base_image = pdf_document.extract_image(xref)\n            image_bytes = base_image[\"image\"]\n            image_ext = base_image[\"ext\"]\n            image_name = f\"page_{page_number + 1}_img_{image_index + 1}.{image_ext}\"\n            \n            image_path = f\"{output_folder}/{image_name}\"\n            \n            # Save the image in its original format\n            with open(image_path, 'wb') as image_file:\n                image_file.write(image_bytes)\n\n    pdf_document.close()\n    print(f\"Images have been extracted to {output_folder}.\")\n\n# Example usage\npdf_path = 'your_document.pdf'\noutput_folder = 'output_images'\nextract_images_from_pdf(pdf_path, output_folder)\n```\n\nThis script will:\n\n1. Open the specified PDF file.\n2. Iterate through each page and extract all images.\n3. Save each image in its original format and resolution to the specified output folder.\n\nMake sure to replace `'your_document.pdf'` and `'output_images'` with your actual PDF file path and desired output directory.\n\nIf you're using Python 2.7, you might need to adjust the script for some syntax differences, but it's recommended to use Python 3.x for compatibility with most modern libraries."
    }
]