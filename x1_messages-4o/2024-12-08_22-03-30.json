[
    {
        "role": "user",
        "content": "Can you provide 3 unique puzzles that involve the use of importance sampling technique to estimate the properties of a specific distribution? Each puzzle should require leveraging different known distributions to sample from. Remember, the solution should involve reasoning and logical thinking. Good luck!"
    },
    {
        "role": "assistant",
        "content": "Certainly! Here are three unique puzzles involving the use of importance sampling to estimate properties of specific distributions:\n\n### Puzzle 1: Estimating the Mean of an Exponential Distribution\n\n**Problem:**  \nYou want to estimate the mean of an exponential distribution with rate parameter \\(\\lambda = 2\\) using importance sampling. However, direct sampling from this distribution is costly. Instead, you can sample from a uniform distribution \\(U(0, 1)\\).\n\n**Tasks:**\n1. Describe how you would set up the importance sampling framework.\n2. Calculate the importance sampling weights.\n3. Estimate the mean of the exponential distribution using this method.\n\n**Solution:**\n1. **Framework Setup:**  \n   The probability density function (pdf) of the exponential distribution is \\(f(x) = \\lambda e^{-\\lambda x}\\) for \\(x \\geq 0\\). The pdf of the uniform distribution is \\(g(x) = 1\\) for \\(x \\in [0, 1]\\).\n   \n2. **Importance Weights:**  \n   For a sample \\(x_i\\) from the uniform distribution, the importance sampling weight is given by:\n   \\[\n   w(x_i) = \\frac{f(x_i)}{g(x_i)} = \\lambda e^{-\\lambda x_i}\n   \\]\n   \n3. **Estimate the Mean:**  \n   To estimate the mean, compute the weighted average:\n   \\[\n   \\hat{\\mu} = \\frac{\\sum_{i=1}^{N} x_i w(x_i)}{\\sum_{i=1}^{N} w(x_i)}\n   \\]\n   By simulating a large number of samples from the uniform distribution, you can estimate the mean of the exponential distribution.\n\n### Puzzle 2: Estimating the Probability of a Tail Event in a Normal Distribution\n\n**Problem:**  \nEstimate the probability that a standard normal variable \\(Z\\) exceeds 3 using importance sampling. Instead of sampling directly from the normal distribution, use a Laplace distribution with location 0 and scale 1.\n\n**Tasks:**\n1. Formulate the importance sampling method.\n2. Determine the importance sampling weights.\n3. Compute the estimated probability.\n\n**Solution:**\n1. **Framework Setup:**  \n   The pdf of the standard normal distribution is \\(f(z) = \\frac{1}{\\sqrt{2\\pi}} e^{-z^2/2}\\). The pdf of the Laplace distribution is \\(g(z) = \\frac{1}{2} e^{-|z|}\\).\n   \n2. **Importance Weights:**  \n   For a sample \\(z_i\\) from the Laplace distribution, the importance weight is:\n   \\[\n   w(z_i) = \\frac{f(z_i)}{g(z_i)} = \\sqrt{2\\pi} e^{z_i^2/2 - |z_i|}\n   \\]\n   \n3. **Estimate the Probability:**  \n   Estimate the probability that \\(Z > 3\\) using:\n   \\[\n   \\hat{P}(Z > 3) = \\frac{1}{N} \\sum_{i=1}^{N} \\mathbf{1}_{\\{z_i > 3\\}} w(z_i)\n   \\]\n   where \\(\\mathbf{1}_{\\{z_i > 3\\}}\\) is an indicator function that is 1 if \\(z_i > 3\\) and 0 otherwise.\n\n### Puzzle 3: Estimating the Expectation of a Function Under a Beta Distribution\n\n**Problem:**  \nEstimate the expectation \\(E[X^3]\\) where \\(X\\) follows a Beta distribution with parameters \\(\\alpha = 2\\) and \\(\\beta = 5\\). Instead of sampling from the Beta distribution, sample from a Gamma distribution with shape \\(\\alpha = 2\\) and rate \\(\\beta = 1\\).\n\n**Tasks:**\n1. Define the importance sampling methodology.\n2. Calculate the importance weights.\n3. Estimate \\(E[X^3]\\).\n\n**Solution:**\n1. **Framework Setup:**  \n   The pdf of the Beta distribution is \\(f(x) = \\frac{x^{\\alpha-1}(1-x)^{\\beta-1}}{B(\\alpha, \\beta)}\\), where \\(B(\\alpha, \\beta)\\) is the beta function. The pdf of the Gamma distribution (transformed to [0, 1]) is \\(g(x) = \\frac{x^{\\alpha-1}e^{-x/\\theta}}{\\theta^\\alpha \\Gamma(\\alpha)}\\) where \\(\\theta = 1/\\beta\\).\n   \n2. **Importance Weights:**  \n   For a sample \\(x_i\\) from the Gamma distribution, the importance weight is:\n   \\[\n   w(x_i) = \\frac{f(x_i)}{g(x_i)}\n   \\]\n   Direct computation requires adjusting for the transformation to the [0, 1] interval.\n   \n3. **Estimate the Expectation:**  \n   The expectation is estimated by:\n   \\[\n   \\hat{E}[X^3] = \\frac{\\sum_{i=1}^{N} x_i^3 w(x_i)}{\\sum_{i=1}^{N} w(x_i)}\n   \\]\n   Simulate a large number of samples and apply the weights to estimate \\(E[X^3]\\).\n\nThese puzzles require leveraging known distributions to estimate properties using importance sampling, employing different logical and mathematical reasoning for each scenario."
    }
]