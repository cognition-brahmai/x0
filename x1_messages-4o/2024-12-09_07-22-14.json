[
    {
        "role": "user",
        "content": "I have a DataFrame with the columns: Communications and Search, Business, General Lifestyle. For each row, I want to find the column name which has the maximum value. How can I achieve this in Python?\n\n<pre><code>\nIn [7]:\nframe.head()\nOut[7]:\nCommunications and Search   Business    General Lifestyle\n0   0.745763    0.050847    0.118644    0.084746\n0   0.333333    0.000000    0.583333    0.083333\n0   0.617021    0.042553    0.297872    0.042553\n0   0.435897    0.000000    0.410256    0.153846\n0   0.358974    0.076923    0.410256    0.153846\n</code></pre>\n\nI'm aiming for an output like this:\n\n<pre><code>\nIn [7]:\n    frame.head()\n    Out[7]:\n    Communications and Search   Business    General Lifestyle   Max\n    0   0.745763    0.050847    0.118644    0.084746           Communications \n    0   0.333333    0.000000    0.583333    0.083333           Business  \n    0   0.617021    0.042553    0.297872    0.042553           Communications \n    0   0.435897    0.000000    0.410256    0.153846           Communications \n    0   0.358974    0.076923    0.410256    0.153846           Business \n</code></pre>"
    },
    {
        "role": "assistant",
        "content": "To achieve this, you can use the `idxmax` function in pandas, which returns the index (or column name) of the first occurrence of the maximum value along an axis. Here's how you can apply it to your DataFrame:\n\n```python\nimport pandas as pd\n\n# Sample DataFrame\ndata = {\n    'Communications and Search': [0.745763, 0.333333, 0.617021, 0.435897, 0.358974],\n    'Business': [0.050847, 0.000000, 0.042553, 0.000000, 0.076923],\n    'General Lifestyle': [0.118644, 0.583333, 0.297872, 0.410256, 0.410256],\n    'Some other column': [0.084746, 0.083333, 0.042553, 0.153846, 0.153846]\n}\n\nframe = pd.DataFrame(data)\n\n# Use idxmax to find the column with the maximum value for each row\nframe['Max'] = frame[['Communications and Search', 'Business', 'General Lifestyle']].idxmax(axis=1)\n\nprint(frame)\n```\n\nThis code creates a new column called 'Max' in your DataFrame, which contains the name of the column with the maximum value for each row. Make sure to adjust the DataFrame and column names to fit your actual data."
    }
]