[
    {
        "role": "user",
        "content": "I have a dataframe in pandas that contains several columns of categorical data. The dataframe structure looks something like this:\n\n```\ncol1        int64\ncol2        int64\ncol3        category\ncol4        category\ncol5        category\n```\n\nA sample column might look like this:\n\n```\nName: col3, dtype: category\nCategories (8, object): [B, C, E, G, H, N, S, W]\n```\n\nI want to convert all the values in each categorical column to an integer format like this: `[1, 2, 3, 4, 5, 6, 7, 8]`. I've been able to achieve this for one column using the following code:\n\n```\ndataframe['c'] = pandas.Categorical.from_array(dataframe.col3).codes\n```\n\nHowever, this method generates a new column in the dataframe while keeping the old `col3` column, and then I have to manually drop the old column. As my dataframe has many columns, this isn't an efficient solution. What is a more clever and efficient way to convert all categorical data to integers in my dataframe?"
    },
    {
        "role": "assistant",
        "content": "You can achieve the conversion of all categorical columns to integer codes by using the `apply` method in combination with a lambda function. This way, you can efficiently convert all categorical columns without manually dropping and renaming columns. Here\u2019s a concise and efficient approach:\n\n```python\nimport pandas as pd\n\n# Sample dataframe creation\ndata = {'col1': [1, 2, 3],\n        'col2': [4, 5, 6],\n        'col3': pd.Categorical(['B', 'C', 'E']),\n        'col4': pd.Categorical(['G', 'H', 'N']),\n        'col5': pd.Categorical(['S', 'W', 'B'])}\n\ndf = pd.DataFrame(data)\n\n# Converting all categorical columns to integer codes\ndf[df.select_dtypes(['category']).columns] = df.select_dtypes(['category']).apply(lambda x: x.cat.codes)\n\nprint(df)\n```\n\n### Explanation:\n1. **Select Categorical Columns**: `df.select_dtypes(['category'])` selects all columns with the `category` data type.\n2. **Apply Transformation**: Use `.apply(lambda x: x.cat.codes)` to convert each categorical column to integer codes. The `cat.codes` property returns the integer codes for the categories.\n3. **Assign Back**: The result is directly assigned back to the original dataframe in the respective categorical columns.\n\nThis method updates the dataframe in place, eliminating the need for creating and dropping columns manually."
    }
]