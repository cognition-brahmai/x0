[
    {
        "role": "user",
        "content": "I am trying to create a scatter plot in pyplot using a Pandas DataFrame object. I want to plot two variables but have the symbols determined by a third column, named 'key1'. I have tried using df.groupby but without success. I have a script that colors the markers according to 'key1', but I would like to see a legend with 'key1' categories. Can you provide a solution to this? Here's my current script:\n```python\nimport numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\n\ndf = pd.DataFrame(np.random.normal(10,1,30).reshape(10,3), index = pd.date_range('2010-01-01', freq = 'M', periods = 10), columns = ('one', 'two', 'three'))\ndf['key1'] = (4,4,4,6,6,6,8,8,8,8)\n\nfig1 = plt.figure(1)\nax1 = fig1.add_subplot(111)\nax1.scatter(df['one'], df['two'], marker = 'o', c = df['key1'], alpha = 0.8)\nplt.show()\n```"
    },
    {
        "role": "assistant",
        "content": "To create a scatter plot where the symbols are determined by a third column ('key1') and to have a legend that shows the categories of 'key1', you can use a loop to plot each category separately and then add a legend. Here's how you can modify your script to achieve this:\n\n```python\nimport numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\n\n# Create the DataFrame\ndf = pd.DataFrame(np.random.normal(10, 1, 30).reshape(10, 3), \n                  index=pd.date_range('2010-01-01', freq='M', periods=10), \n                  columns=('one', 'two', 'three'))\ndf['key1'] = [4, 4, 4, 6, 6, 6, 8, 8, 8, 8]\n\n# Create a figure and axis\nfig1 = plt.figure(1)\nax1 = fig1.add_subplot(111)\n\n# Get unique categories from 'key1'\nunique_keys = df['key1'].unique()\n\n# Loop over unique categories to plot each one separately\nfor key in unique_keys:\n    # Filter the DataFrame for this category\n    df_key = df[df['key1'] == key]\n    # Plot scatter for this category\n    ax1.scatter(df_key['one'], df_key['two'], label=f\"key1 = {key}\", alpha=0.8)\n\n# Add legend\nax1.legend(title=\"key1 Categories\")\n\n# Show plot\nplt.show()\n```\n\nThis script:\n- Loops through each unique value in the 'key1' column.\n- Filters the DataFrame for each 'key1' value.\n- Plots a scatter plot for each subset of data, using a label for the legend.\n- Adds a legend to the plot to distinguish between different categories of 'key1'.\n\nThis way, the legend will show the categories of 'key1', and you can easily see how each category is distributed in the scatter plot."
    }
]