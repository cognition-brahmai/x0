[
    {
        "role": "user",
        "content": "How can I use MATLAB to generate a sine wave with a frequency of 1 Hz and a sampling rate of 100 Hz? Can you also provide code to plot the waveform? Additionally, how can I modify the code to add noise to the signal with a signal-to-noise ratio of 20 dB? Finally, can you provide code to perform a Fourier analysis on the noisy signal and plot the frequency spectrum?"
    },
    {
        "role": "assistant",
        "content": "Certainly! To generate a sine wave with a frequency of 1 Hz and a sampling rate of 100 Hz in MATLAB, you can use the following code. I'll also include steps to add noise to the signal with a signal-to-noise ratio (SNR) of 20 dB, and perform a Fourier analysis on the noisy signal.\n\n### Generating and Plotting the Sine Wave\n\n```matlab\n% Parameters\nFs = 100;           % Sampling frequency (Hz)\nT = 1/Fs;           % Sampling period (s)\nL = 1000;           % Length of signal (number of samples)\nt = (0:L-1)*T;      % Time vector\nf = 1;              % Frequency of sine wave (Hz)\n\n% Generate sine wave\nsine_wave = sin(2*pi*f*t);\n\n% Plot the sine wave\nfigure;\nplot(t, sine_wave);\ntitle('Sine Wave');\nxlabel('Time (s)');\nylabel('Amplitude');\ngrid on;\n```\n\n### Adding Noise with SNR of 20 dB\n\n```matlab\n% Add noise to the signal\nSNR = 20;  % Signal-to-noise ratio in dB\nnoisy_signal = awgn(sine_wave, SNR, 'measured');\n\n% Plot the noisy signal\nfigure;\nplot(t, noisy_signal);\ntitle('Noisy Sine Wave');\nxlabel('Time (s)');\nylabel('Amplitude');\ngrid on;\n```\n\n### Performing Fourier Analysis and Plotting Frequency Spectrum\n\n```matlab\n% Perform Fourier Transform\nY = fft(noisy_signal);\nP2 = abs(Y/L);        % Two-sided spectrum\nP1 = P2(1:L/2+1);     % Single-sided spectrum\nP1(2:end-1) = 2*P1(2:end-1);\n\n% Frequency domain\nf_domain = Fs*(0:(L/2))/L;\n\n% Plot the frequency spectrum\nfigure;\nplot(f_domain, P1);\ntitle('Single-Sided Amplitude Spectrum of Noisy Signal');\nxlabel('Frequency (Hz)');\nylabel('|P1(f)|');\ngrid on;\n```\n\n### Explanation\n\n1. **Generating the Sine Wave**: \n   - We define the sampling frequency `Fs`, the period `T`, and the length `L` of the signal.\n   - The time vector `t` is created to span `L` samples.\n   - A sine wave with frequency `f` is generated using `sin(2*pi*f*t)`.\n\n2. **Adding Noise**:\n   - The `awgn` function from the Communications System Toolbox is used to add Gaussian white noise to the sine wave with a specified SNR.\n\n3. **Fourier Analysis**:\n   - The Fast Fourier Transform (FFT) is applied to the noisy signal.\n   - The two-sided spectrum is calculated and then converted to a single-sided spectrum.\n   - The frequency domain vector `f_domain` is created, and the frequency spectrum is plotted.\n\nThis code will give you a clear view of the sine wave, the noisy signal, and its frequency spectrum. Make sure you have the Communications System Toolbox installed for the `awgn` function."
    }
]