[
    {
        "role": "user",
        "content": "In Flask, how can I set up a route so that when a user visits a specific URL, such as 'http://example.com/get_image?type=1', the server returns a response with a 'image/gif' MIME type? I have two static .gif images - if the type is 1, I want the server to return 'ok.gif', otherwise it should return 'error.gif'. Could anyone explain how to accomplish this?"
    },
    {
        "role": "assistant",
        "content": "To set up a route in Flask that returns a specific image based on a query parameter, you can use the `send_from_directory` function to serve static files. Here's a step-by-step guide to accomplish this:\n\n1. First, ensure you have your Flask environment set up. If not, you can create a new project and install Flask using pip:\n\n   ```bash\n   pip install Flask\n   ```\n\n2. Organize your project directory. You can place your static GIF images in a directory named `static` within your project directory.\n\n3. Create the Flask application with the required route to handle the request:\n\n   ```python\n   from flask import Flask, request, send_from_directory, abort\n\n   app = Flask(__name__)\n\n   @app.route('/get_image')\n   def get_image():\n       # Retrieve the 'type' query parameter from the URL\n       image_type = request.args.get('type')\n\n       # Define the directory where the images are stored\n       image_directory = 'static'\n\n       # Determine which image to return based on the 'type' parameter\n       if image_type == '1':\n           filename = 'ok.gif'\n       else:\n           filename = 'error.gif'\n\n       try:\n           # Use send_from_directory to send the image with the correct MIME type\n           return send_from_directory(image_directory, filename, mimetype='image/gif')\n       except FileNotFoundError:\n           # If the file is not found, return a 404 error\n           abort(404)\n\n   if __name__ == '__main__':\n       app.run(debug=True)\n   ```\n\n4. Ensure that your project directory looks something like this:\n\n   ```\n   your_project/\n   \u251c\u2500\u2500 app.py\n   \u2514\u2500\u2500 static/\n       \u251c\u2500\u2500 ok.gif\n       \u2514\u2500\u2500 error.gif\n   ```\n\n5. Run your Flask application:\n\n   ```bash\n   python app.py\n   ```\n\n6. Now, when you visit `http://localhost:5000/get_image?type=1`, the server will return `ok.gif` with the `image/gif` MIME type. If you visit `http://localhost:5000/get_image?type=2` (or any other value), the server will return `error.gif`.\n\nThis setup uses Flask's capability to serve static files directly, ensuring that the correct MIME type (`image/gif`) is used for the response. Make sure that the filenames and directory structure match what you have in your project."
    }
]