[
    {
        "role": "user",
        "content": "How can I set environment variables in the Supervisor service? I initially attempted to use the command \"export SITE=domain1; python manage.py command\", but Supervisor reported that it couldn't find the command. I then tried the command \"/bin/bash -c \"export SITE=domain1; python manage.py command\"\", which appeared to run, but it interfered with daemonization. When I stopped the Supervisor daemon, none of the other daemons it was running were stopped. Can you help me solve this problem?"
    },
    {
        "role": "assistant",
        "content": "To set environment variables in Supervisor, you can use the `environment` directive within your Supervisor configuration file. This allows you to specify environment variables for your processes without the need for using `export` commands in the command line or creating additional shell scripts. Here's how you can do it:\n\n1. **Edit your Supervisor configuration file**: Locate the configuration file for the specific program you want to run under Supervisor. This is typically found in `/etc/supervisor/conf.d/` or `/etc/supervisord.conf`.\n\n2. **Add the `environment` directive**: Within the `[program:your_program_name]` section of the configuration file, add the `environment` key with your desired environment variables. Here's an example:\n\n   ```ini\n   [program:your_program_name]\n   command=python manage.py command\n   directory=/path/to/your/project\n   autostart=true\n   autorestart=true\n   environment=SITE=\"domain1\",ANOTHER_VAR=\"value\"\n   ```\n\n   In this example, replace `your_program_name` with the name you've assigned to your program, and adjust the `command`, `directory`, and any other settings as needed.\n\n3. **Update Supervisor**: After editing the configuration file, you need to update Supervisor for the changes to take effect. You can do this by running:\n\n   ```bash\n   sudo supervisorctl reread\n   sudo supervisorctl update\n   ```\n\n4. **Restart the program**: If your program is already running under Supervisor and you want to apply the changes immediately, you can restart it with:\n\n   ```bash\n   sudo supervisorctl restart your_program_name\n   ```\n\nBy setting the environment variables in this way, they will be available to the command executed by Supervisor, and you should be able to resolve the issues you were experiencing with daemonization."
    }
]