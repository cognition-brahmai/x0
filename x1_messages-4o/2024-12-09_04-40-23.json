[
    {
        "role": "user",
        "content": "I'm trying to center the data labels in a stacked bar chart using Python's matplotlib library. However, I noticed that the data labels aren't really centered in all rectangles. My current code is as follows:\n\n```python\nimport numpy as np\nimport matplotlib.pyplot as plt\n\nA = [45, 17, 47]\nB = [91, 70, 72]\n\nfig = plt.figure(facecolor=\"white\")\n\nax = fig.add_subplot(1, 1, 1)\nbar_width = 0.5\nbar_l = np.arange(1, 4)\ntick_pos = [i + (bar_width / 2) for i in bar_l]\n\nax1 = ax.bar(bar_l, A, width=bar_width, label=\"A\", color=\"green\")\nax2 = ax.bar(bar_l, B, bottom=A, width=bar_width, label=\"B\", color=\"blue\")\nax.set_ylabel(\"Count\", fontsize=18)\nax.set_xlabel(\"Class\", fontsize=18)\nax.legend(loc=\"best\")\nplt.xticks(tick_pos, [\"C1\", \"C2\", \"C3\"], fontsize=16)\nplt.yticks(fontsize=16)\n\nfor r1, r2 in zip(ax1, ax2):\n    h1 = r1.get_height()\n    h2 = r2.get_height()\n    plt.text(r1.get_x() + r1.get_width() / 2., h1 / 2., \"%d\" % h1, ha=\"center\", va=\"bottom\", color=\"white\", fontsize=16, fontweight=\"bold\")\n    plt.text(r2.get_x() + r2.get_width() / 2., h1 + h2 / 2., \"%d\" % h2, ha=\"center\", va=\"bottom\", color=\"white\", fontsize=16, fontweight=\"bold\")\n\nplt.show()\n```\n\nWhat do I need to modify in my code to center the labels correctly?"
    },
    {
        "role": "assistant",
        "content": "To ensure that the data labels are centered in each segment of the stacked bar chart, you need to adjust the vertical alignment (`va`) parameter in the `plt.text()` function for both the `ax1` and `ax2` bars. Currently, you're using `va=\"bottom\"`, which places the text at the bottom of the specified y-coordinate. To center the text vertically, you should use `va=\"center\"`.\n\nHere's how you can modify your code:\n\n```python\nimport numpy as np\nimport matplotlib.pyplot as plt\n\nA = [45, 17, 47]\nB = [91, 70, 72]\n\nfig = plt.figure(facecolor=\"white\")\n\nax = fig.add_subplot(1, 1, 1)\nbar_width = 0.5\nbar_l = np.arange(1, 4)\ntick_pos = [i + (bar_width / 2) for i in bar_l]\n\nax1 = ax.bar(bar_l, A, width=bar_width, label=\"A\", color=\"green\")\nax2 = ax.bar(bar_l, B, bottom=A, width=bar_width, label=\"B\", color=\"blue\")\nax.set_ylabel(\"Count\", fontsize=18)\nax.set_xlabel(\"Class\", fontsize=18)\nax.legend(loc=\"best\")\nplt.xticks(tick_pos, [\"C1\", \"C2\", \"C3\"], fontsize=16)\nplt.yticks(fontsize=16)\n\nfor r1, r2 in zip(ax1, ax2):\n    h1 = r1.get_height()\n    h2 = r2.get_height()\n    plt.text(r1.get_x() + r1.get_width() / 2., h1 / 2., \"%d\" % h1, ha=\"center\", va=\"center\", color=\"white\", fontsize=16, fontweight=\"bold\")\n    plt.text(r2.get_x() + r2.get_width() / 2., h1 + h2 / 2., \"%d\" % h2, ha=\"center\", va=\"center\", color=\"white\", fontsize=16, fontweight=\"bold\")\n\nplt.show()\n```\n\nBy setting `va=\"center\"`, the text will be vertically centered within each bar segment. This should give you the desired result of having the data labels centered in the bars of your stacked bar chart."
    }
]