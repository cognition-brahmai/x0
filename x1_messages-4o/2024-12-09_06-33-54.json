[
    {
        "role": "user",
        "content": "I am working with a binary classification problem in scikit-learn where I have labeled the positive class as 1 and negative as 0. However, I am having difficulty understanding the setup of scikit-learn's confusion matrix. I am under the impression that by default, scikit-learn uses class 0 as the positive class. Is this correct? Also, in the confusion matrix, which is the positive or negative class in the top row? For instance, if I have the following matrix:\n\n```\nconfusion_matrix(y_test, preds)\n [ [30  5]\n    [2 42] ]\n```\n\nHow does this translate into a confusion matrix? Are the actual instances represented as rows or columns in scikit-learn's confusion matrix? \n\n```\n           prediction                        prediction\n           0       1                          1       0\n         -----   -----                      -----   -----\n      0 | TN   |  FP        (OR)         1 |  TP  |  FP\nactual   -----   -----             actual   -----   -----\n      1 | FN   |  TP                     0 |  FN  |  TN\n```"
    },
    {
        "role": "assistant",
        "content": "In scikit-learn, the confusion matrix is set up so that the rows represent the actual classes and the columns represent the predicted classes. By default, the confusion matrix uses the indices of the classes in sorted order to map them to the matrix. Therefore, if you have two classes, 0 and 1, they will be ordered as 0 (negative class) and 1 (positive class) by default.\n\nGiven your confusion matrix:\n\n```\nconfusion_matrix(y_test, preds)\n [ [30  5]\n   [ 2 42] ]\n```\n\nThis translates into the following confusion matrix:\n\n- The first row represents the actual class 0 (negative class):\n  - 30: True Negatives (TN) - actual 0, predicted 0\n  - 5: False Positives (FP) - actual 0, predicted 1\n\n- The second row represents the actual class 1 (positive class):\n  - 2: False Negatives (FN) - actual 1, predicted 0\n  - 42: True Positives (TP) - actual 1, predicted 1\n\nThus, the confusion matrix is structured as follows:\n\n```\n           Predicted\n           0    1\n         ---- ----\n      0 | TN | FP |  -> Actual 0\n      1 | FN | TP |  -> Actual 1\n```\n\nSo, in your matrix:\n\n- TN = 30\n- FP = 5\n- FN = 2\n- TP = 42\n\nIn summary, the rows represent the true classes (0 and 1), and the columns represent the predicted classes. The top row is for the negative class (0) and the bottom row is for the positive class (1)."
    }
]