[
    {
        "role": "user",
        "content": "How can I display a 'loading' message in a Flask application while a time-consuming function is executed? I am using a form where users can enter a query and the function, which takes between 5 to 30 seconds to return a result, handles the input. I want the user to know that their query is loading during this time. I have also provided some example code for my situation and would appreciate any help.\n\nThe Python code is as follows:\n```python\nfrom flask import Flask\nfrom flask import request\nfrom flask import render_template\nimport time\n\napp = Flask(__name__)\n\ndef long_load(typeback):\n    time.sleep(5) #just simulating the waiting period\n    return \"You typed: %s\" % typeback\n\n@app.route('/')\ndef home():\n    return render_template(\"index.html\")\n\n@app.route('/', methods=['POST'])\ndef form(display=None):\n    query = request.form['anything']\n    outcome = long_load(query)\n    return render_template(\"done.html\", display=outcome)\n\nif __name__ == '__main__':\n    #app.debug = True\n    app.run()\n```\n\nThe HTML code for the form is:\n```html\n<body>\n    <h3>Type anything:</h3>\n    <p>\n    <form action=\".\" method=\"POST\">\n        <input type=\"text\" name=\"anything\" placeholder=\"Type anything here\">\n        <input type=\"submit\" name=\"anything_submit\" value=\"Submit\">\n    </form>\n    </p>    \n</body>\n```\n\nAnd the HTML code for displaying the results is:\n```html\n<body>\n    <h3>Results:</h3>\n    <p>\n        {{ display }}\n    </p>\n</body>\n```"
    },
    {
        "role": "assistant",
        "content": "To display a 'loading' message while the time-consuming function is being executed in a Flask application, you can use JavaScript to provide immediate feedback to the user. The idea is to show a loading message or spinner when the form is submitted, which will remain visible until the server sends back the response.\n\nHere's how you can achieve that:\n\n### Modify the HTML form to include JavaScript:\n\n1. **Add a JavaScript function to display a loading message.**\n2. **Use the `onsubmit` event of the form to trigger this function.**\n\nHere's how you can modify the HTML code:\n\n```html\n<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>Loading Example</title>\n    <style>\n        #loading {\n            display: none;\n            color: blue;\n        }\n    </style>\n    <script>\n        function showLoadingMessage() {\n            document.getElementById('loading').style.display = 'block';\n        }\n    </script>\n</head>\n<body>\n    <h3>Type anything:</h3>\n    <p>\n    <form action=\".\" method=\"POST\" onsubmit=\"showLoadingMessage()\">\n        <input type=\"text\" name=\"anything\" placeholder=\"Type anything here\">\n        <input type=\"submit\" name=\"anything_submit\" value=\"Submit\">\n    </form>\n    </p>\n    <p id=\"loading\">Loading, please wait...</p>\n</body>\n</html>\n```\n\n### Explanation:\n\n- **CSS**: The `#loading` element is initially hidden with `display: none;`.\n- **JavaScript**: The `showLoadingMessage` function sets the `display` property of the `#loading` element to `block`, making it visible.\n- **Form Submission**: The `onsubmit` attribute is used to call `showLoadingMessage` when the form is submitted. This shows the loading message as soon as the user clicks the submit button.\n\nThis approach ensures that the user receives immediate feedback that their request is being processed. The loading message will disappear when the server responds and the new page is loaded with the results."
    }
]