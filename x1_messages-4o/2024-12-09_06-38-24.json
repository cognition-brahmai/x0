[
    {
        "role": "user",
        "content": "How can I repeat rows in a pandas DataFrame based on a specific column value? For example, if I have a DataFrame like this:\n\n```python\n   code      role  persons\n0   123   Janitor        3\n1   123   Analyst        2\n2   321    Vallet        2\n3   321   Auditor        5\n```\n\nThe first line means that I have 3 persons with the role of Janitors. I want to have one line for each person so that my DataFrame would look like this:\n\n```python\n    code      role  persons\n0    123   Janitor        3\n1    123   Janitor        3\n2    123   Janitor        3\n3    123   Analyst        2\n4    123   Analyst        2\n5    321    Vallet        2\n6    321    Vallet        2\n7    321   Auditor        5\n8    321   Auditor        5\n9    321   Auditor        5\n10   321   Auditor        5\n11   321   Auditor        5\n```\nHow can I achieve this using pandas?"
    },
    {
        "role": "assistant",
        "content": "To repeat rows in a pandas DataFrame based on a specific column value, you can use the `repeat` method in combination with `loc` and `reset_index`. Here's a step-by-step guide on how to achieve your desired DataFrame:\n\n```python\nimport pandas as pd\n\n# Initial DataFrame\ndata = {\n    'code': [123, 123, 321, 321],\n    'role': ['Janitor', 'Analyst', 'Vallet', 'Auditor'],\n    'persons': [3, 2, 2, 5]\n}\n\ndf = pd.DataFrame(data)\n\n# Repeat rows based on the 'persons' column\nrepeated_df = df.loc[df.index.repeat(df['persons'])].reset_index(drop=True)\n\n# Display the resulting DataFrame\nprint(repeated_df)\n```\n\n### Explanation:\n1. **`df.index.repeat(df['persons'])`:** This part repeats the index of the DataFrame based on the values in the 'persons' column. For example, if a row has a 'persons' value of 3, its index will be repeated 3 times.\n\n2. **`df.loc[...]`:** This selects rows from the DataFrame based on the repeated indices.\n\n3. **`reset_index(drop=True)`:** This resets the index of the resulting DataFrame to ensure it is sequential (0, 1, 2, ...), and the old index is dropped.\n\nAfter running the above code, you'll get a DataFrame where each row is repeated according to the number of persons specified in the original DataFrame."
    }
]