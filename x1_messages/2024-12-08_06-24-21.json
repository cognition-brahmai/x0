[
    {
        "role": "user",
        "content": "Develop a Python script that connects to a MySQL database, creates a table named \"employees\" with columns for employee ID, name, department, and salary, and inserts sample data into the table. The script should also include a function to query the employees based on their department.\nPLAINFORMAT"
    },
    {
        "role": "assistant",
        "content": "Alright, I'm going to help you create a Python script that connects to a MySQL database, creates a table named \"employees,\" inserts some sample data, and includes a function to query employees based on their department. Let's go through this step by step.\n\nFirst, you'll need to make sure you have the MySQL connector for Python installed. You can install it using pip if you haven't already:\n\n```bash\npip install mysql-connector-python\n```\n\nNow, let's start writing the script. We'll need to import the necessary module and set up the database connection.\n\n```python\nimport mysql.connector\n\n# Database connection parameters\nconfig = {\n    'user': 'your_username',\n    'password': 'your_password',\n    'host': '127.0.0.1',\n    'database': 'your_database',\n    'raise_on_warnings': True\n}\n\n# Connect to the database\ntry:\n    cnx = mysql.connector.connect(**config)\n    print(\"Connection established\")\nexcept mysql.connector.Error as err:\n    if err.errno == errorcode.ER_ACCESS_DENIED_ERROR:\n        print(\"Something is wrong with your user name or password\")\n    elif err.errno == errorcode.ER_BAD_DB_ERROR:\n        print(\"Database does not exist\")\n    else:\n        print(err)\n```\n\nReplace `'your_username'`, `'your_password'`, and `'your_database'` with your actual MySQL username, password, and database name.\n\nNext, we'll create the \"employees\" table. Make sure that the database exists before running this script.\n\n```python\ncursor = cnx.cursor()\n\n# Create the employees table\ncreate_table_query = \"\"\"\nCREATE TABLE IF NOT EXISTS employees (\n    employee_id INT AUTO_INCREMENT PRIMARY KEY,\n    name VARCHAR(100) NOT NULL,\n    department VARCHAR(100) NOT NULL,\n    salary DECIMAL(10, 2) NOT NULL\n)\n\"\"\"\n\ntry:\n    cursor.execute(create_table_query)\n    print(\"Table 'employees' created successfully\")\nexcept mysql.connector.Error as err:\n    print(f\"Error: {err}\")\n```\n\nNow, let's insert some sample data into the \"employees\" table.\n\n```python\n# Sample data to insert\nsample_data = [\n    ('John Doe', 'HR', 50000),\n    ('Jane Smith', 'Finance', 60000),\n    ('Alice Johnson', 'IT', 70000),\n    ('Bob Brown', 'HR', 55000),\n    ('Charlie Davis', 'Finance', 65000)\n]\n\n# Insert data into the employees table\ninsert_query = \"\"\"\nINSERT INTO employees (name, department, salary)\nVALUES (%s, %s, %s)\n\"\"\"\n\ntry:\n    cursor.executemany(insert_query, sample_data)\n    cnx.commit()\n    print(\"Sample data inserted successfully\")\nexcept mysql.connector.Error as err:\n    print(f\"Error: {err}\")\n```\n\nFinally, let's create a function to query employees based on their department.\n\n```python\ndef get_employees_by_department(department):\n    query = f\"SELECT * FROM employees WHERE department = %s\"\n    cursor.execute(query, (department,))\n    result = cursor.fetchall()\n    return result\n\n# Example usage:\ndepartment = 'HR'\nemployees = get_employees_by_department(department)\nfor emp in employees:\n    print(emp)\n```\n\nDon't forget to close the database connection when you're done.\n\n```python\ncursor.close()\ncnx.close()\nprint(\"Connection closed\")\n```\n\nPutting it all together, your complete script should look like this:\n\n```python\nimport mysql.connector\nfrom mysql.connector import errorcode\n\n# Database connection parameters\nconfig = {\n    'user': 'your_username',\n    'password': 'your_password',\n    'host': '127.0.0.1',\n    'database': 'your_database',\n    'raise_on_warnings': True\n}\n\n# Connect to the database\ntry:\n    cnx = mysql.connector.connect(**config)\n    print(\"Connection established\")\nexcept mysql.connector.Error as err:\n    if err.errno == errorcode.ER_ACCESS_DENIED_ERROR:\n        print(\"Something is wrong with your user name or password\")\n    elif err.errno == errorcode.ER_BAD_DB_ERROR:\n        print(\"Database does not exist\")\n    else:\n        print(err)\n\ncursor = cnx.cursor()\n\n# Create the employees table\ncreate_table_query = \"\"\"\nCREATE TABLE IF NOT EXISTS employees (\n    employee_id INT AUTO_INCREMENT PRIMARY KEY,\n    name VARCHAR(100) NOT NULL,\n    department VARCHAR(100) NOT NULL,\n    salary DECIMAL(10, 2) NOT NULL\n)\n\"\"\"\n\ntry:\n    cursor.execute(create_table_query)\n    print(\"Table 'employees' created successfully\")\nexcept mysql.connector.Error as err:\n    print(f\"Error: {err}\")\n\n# Sample data to insert\nsample_data = [\n    ('John Doe', 'HR', 50000),\n    ('Jane Smith', 'Finance', 60000),\n    ('Alice Johnson', 'IT', 70000),\n    ('Bob Brown', 'HR', 55000),\n    ('Charlie Davis', 'Finance', 65000)\n]\n\n# Insert data into the employees table\ninsert_query = \"\"\"\nINSERT INTO employees (name, department, salary)\nVALUES (%s, %s, %s)\n\"\"\"\n\ntry:\n    cursor.executemany(insert_query, sample_data)\n    cnx.commit()\n    print(\"Sample data inserted successfully\")\nexcept mysql.connector.Error as err:\n    print(f\"Error: {err}\")\n\ndef get_employees_by_department(department):\n    query = f\"SELECT * FROM employees WHERE department = %s\"\n    cursor.execute(query, (department,))\n    result = cursor.fetchall()\n    return result\n\n# Example usage:\ndepartment = 'HR'\nemployees = get_employees_by_department(department)\nfor emp in employees:\n    print(emp)\n\ncursor.close()\ncnx.close()\nprint(\"Connection closed\")\n```\n\nMake sure to handle exceptions and close resources properly to avoid any leaks. This script should help you get started with connecting to a MySQL database, creating a table, inserting data, and querying data based on specific criteria."
    }
]