[
    {
        "role": "user",
        "content": "Develop a Python script that connects to a MySQL database, creates a table called \"employees\" with columns id (integer), name (varchar), and age (integer), and inserts 5 sample records into the table."
    },
    {
        "role": "assistant",
        "content": "I'm here to help! Let's create a Python script that connects to a MySQL database, creates a table named \"employees,\" and inserts five sample records into it. I'll walk you through the process step by step.\n\nFirst, make sure you have MySQL installed and running on your system. You'll also need the `mysql-connector-python` package to connect Python to MySQL. If you haven't installed it yet, you can do so using pip:\n\n```bash\npip install mysql-connector-python\n```\n\nNow, let's start writing the Python script.\n\n1. **Import the MySQL connector:**\n\n```python\nimport mysql.connector\nfrom mysql.connector import Error\n```\n\n2. **Establish a connection to the MySQL database:**\n\nYou'll need to provide your database's host, database name, username, and password. Replace the placeholders with your actual database credentials.\n\n```python\ntry:\n    connection = mysql.connector.connect(\n        host='your_host',\n        database='your_database',\n        user='your_username',\n        password='your_password'\n    )\n\n    if connection.is_connected():\n        print(\"Successfully connected to the database\")\nexcept Error as e:\n    print(f\"Error connecting to MySQL: {e}\")\n```\n\n3. **Create a cursor object to interact with the database:**\n\n```python\ncursor = connection.cursor()\n```\n\n4. **Define the SQL query to create the \"employees\" table:**\n\n```python\ncreate_table_query = '''\nCREATE TABLE IF NOT EXISTS employees (\n    id INT AUTO_INCREMENT PRIMARY KEY,\n    name VARCHAR(100) NOT NULL,\n    age INT NOT NULL\n)\n'''\n```\n\n5. **Execute the query to create the table:**\n\n```python\ncursor.execute(create_table_query)\nprint(\"Table 'employees' created successfully\")\n```\n\n6. **Define the sample records to insert into the table:**\n\n```python\nsample_records = [\n    (1, 'John Doe', 30),\n    (2, 'Jane Smith', 25),\n    (3, 'Mike Johnson', 35),\n    (4, 'Emily Davis', 28),\n    (5, 'David Wilson', 40)\n]\n```\n\n7. **Prepare the SQL query for inserting records:**\n\n```python\ninsert_query = \"\"\"\nINSERT INTO employees (id, name, age) VALUES (%s, %s, %s)\n\"\"\"\n```\n\n8. **Execute the insert query for each sample record:**\n\n```python\ntry:\n    cursor.executemany(insert_query, sample_records)\n    connection.commit()\n    print(\"Records inserted successfully\")\nexcept Error as e:\n    connection.rollback()\n    print(f\"Failed to insert records: {e}\")\n```\n\n9. **Close the cursor and connection to clean up:**\n\n```python\ncursor.close()\nconnection.close()\nprint(\"Database connection closed\")\n```\n\nPutting it all together, your complete script should look like this:\n\n```python\nimport mysql.connector\nfrom mysql.connector import Error\n\ntry:\n    connection = mysql.connector.connect(\n        host='your_host',\n        database='your_database',\n        user='your_username',\n        password='your_password'\n    )\n\n    if connection.is_connected():\n        print(\"Successfully connected to the database\")\nexcept Error as e:\n    print(f\"Error connecting to MySQL: {e}\")\n\ncursor = connection.cursor()\n\ncreate_table_query = '''\nCREATE TABLE IF NOT EXISTS employees (\n    id INT AUTO_INCREMENT PRIMARY KEY,\n    name VARCHAR(100) NOT NULL,\n    age INT NOT NULL\n)\n'''\n\ncursor.execute(create_table_query)\nprint(\"Table 'employees' created successfully\")\n\nsample_records = [\n    (1, 'John Doe', 30),\n    (2, 'Jane Smith', 25),\n    (3, 'Mike Johnson', 35),\n    (4, 'Emily Davis', 28),\n    (5, 'David Wilson', 40)\n]\n\ninsert_query = \"\"\"\nINSERT INTO employees (id, name, age) VALUES (%s, %s, %s)\n\"\"\"\n\ntry:\n    cursor.executemany(insert_query, sample_records)\n    connection.commit()\n    print(\"Records inserted successfully\")\nexcept Error as e:\n    connection.rollback()\n    print(f\"Failed to insert records: {e}\")\n\ncursor.close()\nconnection.close()\nprint(\"Database connection closed\")\n```\n\nMake sure to replace `'your_host'`, `'your_database'`, `'your_username'`, and `'your_password'` with your actual database connection details.\n\nThis script connects to your MySQL database, creates a table named \"employees\" if it doesn't exist, and inserts five sample records into it. It also handles exceptions and ensures that the database connection is properly closed after operations."
    }
]