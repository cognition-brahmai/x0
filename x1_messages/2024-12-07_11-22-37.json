[
    {
        "role": "user",
        "content": "Develop a PHP script that connects to a MySQL database and retrieves data from a table named \"employees\" with columns \"id\", \"first_name\", \"last_name\", \"email\", and \"salary\". The script should display the employees' full names and emails in an HTML table, and calculate the average salary of all employees."
    },
    {
        "role": "assistant",
        "content": "To create a PHP script that connects to a MySQL database and retrieves data from the \"employees\" table, you'll need to follow these steps:\n\n1. **Set up your database connection:** You need to provide the database host, username, password, and database name.\n\n2. **Write a SQL query to retrieve the required data:** In this case, you need to select \"first_name\", \"last_name\", and \"email\" from the \"employees\" table.\n\n3. **Execute the query and fetch the results:** Use PHP's MySQL functions to execute the query and retrieve the data.\n\n4. **Display the data in an HTML table:** Loop through the results and create table rows for each employee.\n\n5. **Calculate the average salary:** Sum up all the salaries and divide by the number of employees.\n\nBelow is a sample PHP script that accomplishes these tasks. Make sure to replace the database connection details with your actual database credentials.\n\n```php\n<?php\n// Database connection parameters\n$host = 'localhost';\n$username = 'your_username';\n$password = 'your_password';\n$dbname = 'your_database';\n\n// Create connection\n$conn = new mysqli($host, $username, $password, $dbname);\n\n// Check connection\nif ($conn->connect_error) {\n    die(\"Connection failed: \" . $conn->connect_error);\n}\n\n// SQL query to select employees' first_name, last_name, and email\n$sql = \"SELECT first_name, last_name, email, salary FROM employees\";\n$result = $conn->query($sql);\n\nif ($result->num_rows > 0) {\n    // Initialize variables for average salary calculation\n    $totalSalary = 0;\n    $employeeCount = 0;\n\n    // Start HTML table\n    echo \"<table border='1'>\n            <tr>\n                <th>Full Name</th>\n                <th>Email</th>\n            </tr>\";\n\n    // Output data of each row\n    while($row = $result->fetch_assoc()) {\n        echo \"<tr>\n                <td>\" . $row[\"first_name\"] . \" \" . $row[\"last_name\"] . \"</td>\n                <td>\" . $row[\"email\"] . \"</td>\n              </tr>\";\n        \n        // Calculate total salary and count of employees\n        $totalSalary += $row[\"salary\"];\n        $employeeCount++;\n    }\n\n    // Close HTML table\n    echo \"</table>\";\n\n    // Calculate average salary\n    if ($employeeCount > 0) {\n        $averageSalary = $totalSalary / $employeeCount;\n        echo \"<p>Average Salary: \" . number_format($averageSalary, 2) . \"</p>\";\n    } else {\n        echo \"<p>No employees found.</p>\";\n    }\n} else {\n    echo \"0 results\";\n}\n\n// Close connection\n$conn->close();\n?>\n```\n\n### Explanation:\n\n1. **Database Connection:** We use `mysqli` to connect to the MySQL database. Replace `'localhost'`, `'your_username'`, `'your_password'`, and `'your_database'` with your actual database connection details.\n\n2. **SQL Query:** The query selects `first_name`, `last_name`, `email`, and `salary` from the `employees` table.\n\n3. **Fetching Results:** We check if there are any rows returned. If yes, we start building an HTML table to display the full names and emails.\n\n4. **Average Salary Calculation:** While iterating through the rows, we accumulate the salaries and count the number of employees to calculate the average salary.\n\n5. **Displaying Results:** The employee data is displayed in an HTML table, and the average salary is shown below the table.\n\n6. **Closing the Connection:** Finally, we close the database connection using `$conn->close()`.\n"
    }
]