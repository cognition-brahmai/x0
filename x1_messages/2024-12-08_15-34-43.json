[
    {
        "role": "user",
        "content": "Write a Python script that connects to a MariaDB database, creates a table called \"users\" with columns for id, name, email, and age, and inserts sample data into the table. Then, write a query to retrieve all users whose age is between 18 and 30.\nPLAINFORMAT"
    },
    {
        "role": "assistant",
        "content": "Alright, I'll help you with that. First, make sure you have MariaDB installed and running on your system. Also, ensure that you have the `mysql-connector-python` package installed in your Python environment. You can install it using pip if you haven't already:\n\n```bash\npip install mysql-connector-python\n```\n\nNow, let's proceed step by step.\n\n### Step 1: Connect to the MariaDB Database\n\nYou need to establish a connection to your MariaDB database. For this example, I'll assume you have a database named `mydatabase`. You'll need to provide your database host, user, password, and database name.\n\n```python\nimport mysql.connector\n\n# Database connection parameters\nconfig = {\n    'user': 'your_username',\n    'password': 'your_password',\n    'host': '127.0.0.1',\n    'database': 'mydatabase',\n    'raise_on_warnings': True\n}\n\n# Establishing the connection\ntry:\n    cnx = mysql.connector.connect(**config)\n    print(\"Connection established\")\nexcept mysql.connector.Error as err:\n    print(f\"Error connecting to database: {err}\")\n    exit(1)\n```\n\n### Step 2: Create the \"users\" Table\n\nOnce connected, you can create a table named \"users\" with the specified columns: id, name, email, and age.\n\n```python\ncursor = cnx.cursor()\n\n# SQL statement to create the table\ncreate_table_query = '''\nCREATE TABLE IF NOT EXISTS users (\n    id INT AUTO_INCREMENT PRIMARY KEY,\n    name VARCHAR(100) NOT NULL,\n    email VARCHAR(100) NOT NULL,\n    age INT NOT NULL\n)\n'''\n\ntry:\n    cursor.execute(create_table_query)\n    print(\"Table 'users' created successfully\")\nexcept mysql.connector.Error as err:\n    print(f\"Error creating table: {err}\")\n```\n\n### Step 3: Insert Sample Data into the \"users\" Table\n\nLet's insert some sample data into the \"users\" table.\n\n```python\n# Sample data to insert\nsample_data = [\n    ('John Doe', 'john@example.com', 25),\n    ('Jane Smith', 'jane@example.com', 22),\n    ('Alice Johnson', 'alice@example.com', 31),\n    ('Bob Brown', 'bob@example.com', 19)\n]\n\n# SQL statement to insert data\ninsert_query = '''\nINSERT INTO users (name, email, age) VALUES (%s, %s, %s)\n'''\n\ntry:\n    cursor.executemany(insert_query, sample_data)\n    cnx.commit()  # Don't forget to commit the transaction\n    print(\"Sample data inserted successfully\")\nexcept mysql.connector.Error as err:\n    print(f\"Error inserting data: {err}\")\n```\n\n### Step 4: Retrieve Users Whose Age is Between 18 and 30\n\nNow, let's write a query to select users whose age is between 18 and 30.\n\n```python\n# SQL query to select users aged between 18 and 30\nselect_query = '''\nSELECT * FROM users WHERE age BETWEEN 18 AND 30\n'''\n\ntry:\n    cursor.execute(select_query)\n    users = cursor.fetchall()\n    print(\"Users aged between 18 and 30:\")\n    for user in users:\n        print(user)\nexcept mysql.connector.Error as err:\n    print(f\"Error retrieving data: {err}\")\n```\n\n### Step 5: Close the Database Connection\n\nFinally, make sure to close the cursor and the connection to clean up.\n\n```python\ncursor.close()\ncnx.close()\nprint(\"Connection closed\")\n```\n\n### Complete Script\n\nPutting it all together, here's the complete Python script:\n\n```python\nimport mysql.connector\n\n# Database connection parameters\nconfig = {\n    'user': 'your_username',\n    'password': 'your_password',\n    'host': '127.0.0.1',\n    'database': 'mydatabase',\n    'raise_on_warnings': True\n}\n\ntry:\n    cnx = mysql.connector.connect(**config)\n    print(\"Connection established\")\nexcept mysql.connector.Error as err:\n    print(f\"Error connecting to database: {err}\")\n    exit(1)\n\ncursor = cnx.cursor()\n\n# Create table\ncreate_table_query = '''\nCREATE TABLE IF NOT EXISTS users (\n    id INT AUTO_INCREMENT PRIMARY KEY,\n    name VARCHAR(100) NOT NULL,\n    email VARCHAR(100) NOT NULL,\n    age INT NOT NULL\n)\n'''\n\ntry:\n    cursor.execute(create_table_query)\n    print(\"Table 'users' created successfully\")\nexcept mysql.connector.Error as err:\n    print(f\"Error creating table: {err}\")\n\n# Insert sample data\nsample_data = [\n    ('John Doe', 'john@example.com', 25),\n    ('Jane Smith', 'jane@example.com', 22),\n    ('Alice Johnson', 'alice@example.com', 31),\n    ('Bob Brown', 'bob@example.com', 19)\n]\n\ninsert_query = '''\nINSERT INTO users (name, email, age) VALUES (%s, %s, %s)\n'''\n\ntry:\n    cursor.executemany(insert_query, sample_data)\n    cnx.commit()\n    print(\"Sample data inserted successfully\")\nexcept mysql.connector.Error as err:\n    print(f\"Error inserting data: {err}\")\n\n# Retrieve users aged between 18 and 30\nselect_query = '''\nSELECT * FROM users WHERE age BETWEEN 18 AND 30\n'''\n\ntry:\n    cursor.execute(select_query)\n    users = cursor.fetchall()\n    print(\"Users aged between 18 and 30:\")\n    for user in users:\n        print(user)\nexcept mysql.connector.Error as err:\n    print(f\"Error retrieving data: {err}\")\n\n# Close connection\ncursor.close()\ncnx.close()\nprint(\"Connection closed\")\n```\n\nMake sure to replace `'your_username'`, `'your_password'`, and `'mydatabase'` with your actual database credentials and database name.\n\nThis script will connect to your MariaDB database, create a table named \"users\", insert some sample data, and then retrieve and print the users who are between 18 and 30 years old."
    }
]