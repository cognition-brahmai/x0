[
    {
        "role": "user",
        "content": "Using SQL, write queries to perform the following tasks on a given database: \n- Find all customers who have not placed any orders.\n- Update the stock level of a product after a sale.\n- Delete all orders that were placed more than a year ago.\n- Retrieve the total sales for each category of products."
    },
    {
        "role": "assistant",
        "content": "Certainly! I'll help you with those SQL queries. Please make sure that the database schema matches the assumptions I'm making here. If your tables have different names or structures, you might need to adjust the queries accordingly.\n\n### 1. Find all customers who have not placed any orders.\n\nAssuming you have two tables: `customers` and `orders`, where `customers` has a `customer_id` and `orders` has a `customer_id` referencing `customers`.\n\n#### Query:\n```sql\nSELECT c.customer_id, c.customer_name\nFROM customers c\nLEFT JOIN orders o ON c.customer_id = o.customer_id\nWHERE o.order_id IS NULL;\n```\n\n### 2. Update the stock level of a product after a sale.\n\nAssuming you have a `products` table with columns `product_id`, `product_name`, and `stock_level`. Let's say you sold a quantity of `quantity_sold` for a specific `product_id`.\n\n#### Query:\n```sql\nUPDATE products\nSET stock_level = stock_level - :quantity_sold\nWHERE product_id = :product_id;\n```\n\n### 3. Delete all orders that were placed more than a year ago.\n\nAssuming the `orders` table has a `order_date` column.\n\n#### Query:\n```sql\nDELETE FROM orders\nWHERE order_date < DATE_SUB(CURRENT_DATE, INTERVAL 1 YEAR);\n```\n\n### 4. Retrieve the total sales for each category of products.\n\nAssuming you have three tables: `products`, `categories`, and `order_details`. The `products` table has `product_id`, `category_id`, and `price`. The `order_details` table has `order_id`, `product_id`, and `quantity`.\n\n#### Query:\n```sql\nSELECT c.category_name, SUM(p.price * od.quantity) AS total_sales\nFROM categories c\nJOIN products p ON c.category_id = p.category_id\nJOIN order_details od ON p.product_id = od.product_id\nGROUP BY c.category_name;\n```\n\nThese queries should cover the tasks you've described. If you have any specific variations or need further assistance, feel free to ask!"
    }
]