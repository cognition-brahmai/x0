[
    {
        "role": "user",
        "content": "Create a Python script that connects to a PostgreSQL database, creates a table called \"products\" with columns: id (integer), name (varchar), price (float), and quantity (integer). Then, insert 10 sample records into the table.\nPLAINFORMAT"
    },
    {
        "role": "assistant",
        "content": "Alright, I'll guide you through creating a Python script that connects to a PostgreSQL database, creates a table named \"products,\" and inserts 10 sample records into it. Make sure you have PostgreSQL installed and a database set up before starting.\n\nFirst, you'll need to install the `psycopg2` library, which is a PostgreSQL adapter for Python. You can install it using pip:\n\n```bash\npip install psycopg2\n```\n\nNow, let's write the Python script step by step.\n\n1. **Import the necessary module:**\n\n```python\nimport psycopg2\n```\n\n2. **Establish a connection to the PostgreSQL database:**\n\nYou'll need to provide your database name, user, password, and host. Adjust these parameters according to your setup.\n\n```python\ntry:\n    conn = psycopg2.connect(\n        database=\"your_database_name\",\n        user=\"your_username\",\n        password=\"your_password\",\n        host=\"127.0.0.1\",\n        port=\"5432\"\n    )\n    print(\"Connected to the database\")\nexcept Exception as e:\n    print(f\"An error occurred while connecting to the database: {e}\")\n```\n\n3. **Create a cursor object to interact with the database:**\n\n```python\ncur = conn.cursor()\n```\n\n4. **Create the \"products\" table:**\n\nDefine the SQL query to create the table with the specified columns.\n\n```python\ncreate_table_query = '''\nCREATE TABLE products (\n    id INTEGER PRIMARY KEY,\n    name VARCHAR(255) NOT NULL,\n    price FLOAT NOT NULL,\n    quantity INTEGER NOT NULL\n);\n'''\n\ntry:\n    cur.execute(create_table_query)\n    conn.commit()\n    print(\"Table 'products' created successfully\")\nexcept Exception as e:\n    conn.rollback()\n    print(f\"An error occurred while creating the table: {e}\")\n```\n\n5. **Insert 10 sample records into the \"products\" table:**\n\nPrepare the SQL query for inserting data and execute it.\n\n```python\nsample_products = [\n    (1, 'Laptop', 1200.50, 10),\n    (2, 'Smartphone', 800.25, 15),\n    (3, 'Tablet', 450.75, 20),\n    (4, 'Monitor', 250.00, 12),\n    (5, 'Keyboard', 50.50, 30),\n    (6, 'Mouse', 25.75, 40),\n    (7, 'Headphones', 80.00, 25),\n    (8, 'Speaker', 150.25, 18),\n    (9, 'Printer', 200.50, 10),\n    (10, 'Webcam', 75.00, 22)\n]\n\ninsert_query = '''\nINSERT INTO products (id, name, price, quantity)\nVALUES (%s, %s, %s, %s);\n'''\n\ntry:\n    cur.executemany(insert_query, sample_products)\n    conn.commit()\n    print(\"Sample records inserted successfully\")\nexcept Exception as e:\n    conn.rollback()\n    print(f\"An error occurred while inserting records: {e}\")\n```\n\n6. **Close the cursor and connection:**\n\nIt's important to close the cursor and the connection once you're done to free up resources.\n\n```python\ncur.close()\nconn.close()\nprint(\"Database connection closed\")\n```\n\nPutting it all together, your complete Python script should look like this:\n\n```python\nimport psycopg2\n\ntry:\n    conn = psycopg2.connect(\n        database=\"your_database_name\",\n        user=\"your_username\",\n        password=\"your_password\",\n        host=\"127.0.0.1\",\n        port=\"5432\"\n    )\n    print(\"Connected to the database\")\nexcept Exception as e:\n    print(f\"An error occurred while connecting to the database: {e}\")\n\ncur = conn.cursor()\n\ncreate_table_query = '''\nCREATE TABLE products (\n    id INTEGER PRIMARY KEY,\n    name VARCHAR(255) NOT NULL,\n    price FLOAT NOT NULL,\n    quantity INTEGER NOT NULL\n);\n'''\n\ntry:\n    cur.execute(create_table_query)\n    conn.commit()\n    print(\"Table 'products' created successfully\")\nexcept Exception as e:\n    conn.rollback()\n    print(f\"An error occurred while creating the table: {e}\")\n\nsample_products = [\n    (1, 'Laptop', 1200.50, 10),\n    (2, 'Smartphone', 800.25, 15),\n    (3, 'Tablet', 450.75, 20),\n    (4, 'Monitor', 250.00, 12),\n    (5, 'Keyboard', 50.50, 30),\n    (6, 'Mouse', 25.75, 40),\n    (7, 'Headphones', 80.00, 25),\n    (8, 'Speaker', 150.25, 18),\n    (9, 'Printer', 200.50, 10),\n    (10, 'Webcam', 75.00, 22)\n]\n\ninsert_query = '''\nINSERT INTO products (id, name, price, quantity)\nVALUES (%s, %s, %s, %s);\n'''\n\ntry:\n    cur.executemany(insert_query, sample_products)\n    conn.commit()\n    print(\"Sample records inserted successfully\")\nexcept Exception as e:\n    conn.rollback()\n    print(f\"An error occurred while inserting records: {e}\")\n\ncur.close()\nconn.close()\nprint(\"Database connection closed\")\n```\n\nMake sure to replace `\"your_database_name\"`, `\"your_username\"`, and `\"your_password\"` with your actual database credentials.\n\nThis script will connect to your PostgreSQL database, create a table named \"products\" with the specified columns, and insert 10 sample product records into it."
    }
]